var uc=Object.defineProperty;var fc=(ce,oe,N)=>oe in ce?uc(ce,oe,{enumerable:!0,configurable:!0,writable:!0,value:N}):ce[oe]=N;var ge=(ce,oe,N)=>fc(ce,typeof oe!="symbol"?oe+"":oe,N);(function(){"use strict";var ce={},oe=function(e,n,t,r,i){var s=new Worker(ce[n]||(ce[n]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return s.onmessage=function(o){var a=o.data,l=a.$e$;if(l){var c=new Error(l[0]);c.code=l[1],c.stack=l[2],i(c,null)}else i(null,a)},s.postMessage(t,r),s},N=Uint8Array,ve=Uint16Array,$n=Int32Array,tn=new N([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rn=new N([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Bn=new N([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vn=function(e,n){for(var t=new ve(31),r=0;r<31;++r)t[r]=n+=1<<e[r-1];for(var i=new $n(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return{b:t,r:i}},Un=Vn(tn,2),sn=Un.b,$i=Un.r;sn[28]=258,$i[258]=28;for(var Bi=Vn(rn,0),Gn=Bi.b,Oe=new ve(32768),b=0;b<32768;++b){var ue=(b&43690)>>1|(b&21845)<<1;ue=(ue&52428)>>2|(ue&13107)<<2,ue=(ue&61680)>>4|(ue&3855)<<4,Oe[b]=((ue&65280)>>8|(ue&255)<<8)>>1}for(var we=function(e,n,t){for(var r=e.length,i=0,s=new ve(n);i<r;++i)e[i]&&++s[e[i]-1];var o=new ve(n);for(i=1;i<n;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new ve(1<<n);var l=15-n;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=n-e[i],f=o[e[i]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)a[Oe[f]>>l]=c}else for(a=new ve(r),i=0;i<r;++i)e[i]&&(a[i]=Oe[o[e[i]-1]++]>>15-e[i]);return a},Ee=new N(288),b=0;b<144;++b)Ee[b]=8;for(var b=144;b<256;++b)Ee[b]=9;for(var b=256;b<280;++b)Ee[b]=7;for(var b=280;b<288;++b)Ee[b]=8;for(var jn=new N(32),b=0;b<32;++b)jn[b]=5;var zn=we(Ee,9,1),Yn=we(jn,5,1),De=function(e){for(var n=e[0],t=1;t<e.length;++t)e[t]>n&&(n=e[t]);return n},X=function(e,n,t){var r=n/8|0;return(e[r]|e[r+1]<<8)>>(n&7)&t},We=function(e,n){var t=n/8|0;return(e[t]|e[t+1]<<8|e[t+2]<<16)>>(n&7)},Kn=function(e){return(e+7)/8|0},He=function(e,n,t){return(n==null||n<0)&&(n=0),(t==null||t>e.length)&&(t=e.length),new N(e.subarray(n,t))},qn=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],B=function(e,n,t){var r=new Error(n||qn[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,B),!t)throw r;return r},Xn=function(e,n,t,r){var i=e.length,s=r?r.length:0;if(!i||n.f&&!n.l)return t||new N(0);var o=!t,a=o||n.i!=2,l=n.i;o&&(t=new N(i*3));var c=function(Di){var Wi=t.length;if(Di>Wi){var Hi=new N(Math.max(Wi*2,Di));Hi.set(t),t=Hi}},u=n.f||0,f=n.p||0,p=n.b||0,d=n.l,m=n.d,h=n.m,S=n.n,w=i*8;do{if(!d){u=X(e,f,1);var g=X(e,f+1,3);if(f+=3,g)if(g==1)d=zn,m=Yn,h=9,S=5;else if(g==2){var j=X(e,f,31)+257,Y=X(e,f+10,15)+4,K=j+X(e,f+5,31)+1;f+=14;for(var D=new N(K),Z=new N(19),E=0;E<Y;++E)Z[Bn[E]]=X(e,f+E*3,7);f+=Y*3;for(var k=De(Z),q=(1<<k)-1,R=we(Z,k,1),E=0;E<K;){var Q=R[X(e,f,q)];f+=Q&15;var _=Q>>4;if(_<16)D[E++]=_;else{var H=0,J=0;for(_==16?(J=3+X(e,f,3),f+=2,H=D[E-1]):_==17?(J=3+X(e,f,7),f+=3):_==18&&(J=11+X(e,f,127),f+=7);J--;)D[E++]=H}}var U=D.subarray(0,j),M=D.subarray(j);h=De(U),S=De(M),d=we(U,h,1),m=we(M,S,1)}else B(1);else{var _=Kn(f)+4,I=e[_-4]|e[_-3]<<8,x=_+I;if(x>i){l&&B(0);break}a&&c(p+I),t.set(e.subarray(_,x),p),n.b=p+=I,n.p=f=x*8,n.f=u;continue}if(f>w){l&&B(0);break}}a&&c(p+131072);for(var me=(1<<h)-1,A=(1<<S)-1,z=f;;z=f){var H=d[We(e,f)&me],L=H>>4;if(f+=H&15,f>w){l&&B(0);break}if(H||B(2),L<256)t[p++]=L;else if(L==256){z=f,d=null;break}else{var se=L-254;if(L>264){var E=L-257,he=tn[E];se=X(e,f,(1<<he)-1)+sn[E],f+=he}var Pe=m[We(e,f)&A],Hn=Pe>>4;Pe||B(3),f+=Pe&15;var M=Gn[Hn];if(Hn>3){var he=rn[Hn];M+=We(e,f)&(1<<he)-1,f+=he}if(f>w){l&&B(0);break}a&&c(p+131072);var Pi=p+se;if(p<M){var Oi=s-M,cc=Math.min(M,Pi);for(Oi+p<0&&B(3);p<cc;++p)t[p]=r[Oi+p]}for(;p<Pi;++p)t[p]=t[p-M]}}n.l=d,n.p=z,n.b=p,n.f=u,d&&(u=1,n.m=h,n.d=m,n.n=S)}while(!u);return p!=t.length&&o?He(t,0,p):t.subarray(0,p)},Vi=new N(0),Ui=function(e,n){var t={};for(var r in e)t[r]=e[r];for(var r in n)t[r]=n[r];return t},Zn=function(e,n,t){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<r.length;++o){var a=r[o],l=s[o];if(typeof a=="function"){n+=";"+l+"=";var c=a.toString();if(a.prototype)if(c.indexOf("[native code]")!=-1){var u=c.indexOf(" ",8)+1;n+=c.slice(u,c.indexOf("(",u))}else{n+=c;for(var f in a.prototype)n+=";"+l+".prototype."+f+"="+a.prototype[f].toString()}else n+=c}else t[l]=a}return n},$e=[],Gi=function(e){var n=[];for(var t in e)e[t].buffer&&n.push((e[t]=new e[t].constructor(e[t])).buffer);return n},ji=function(e,n,t,r){if(!$e[t]){for(var i="",s={},o=e.length-1,a=0;a<o;++a)i=Zn(e[a],i,s);$e[t]={c:Zn(e[o],i,s),e:s}}var l=Ui({},$e[t].e);return oe($e[t].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+n.toString()+"}",t,l,Gi(l),r)},zi=function(){return[N,ve,$n,tn,rn,Bn,sn,Gn,zn,Yn,Oe,qn,we,De,X,We,Kn,He,B,Xn,an,Qn,Jn]},Qn=function(e){return postMessage(e,[e.buffer])},Jn=function(e){return e&&{out:e.size&&new N(e.size),dictionary:e.dictionary}},Yi=function(e,n,t,r,i,s){var o=ji(t,r,i,function(a,l){o.terminate(),s(a,l)});return o.postMessage([e,n],n.consume?[e.buffer]:[]),function(){o.terminate()}},te=function(e,n){return e[n]|e[n+1]<<8},ee=function(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24)>>>0},on=function(e,n){return ee(e,n)+ee(e,n+4)*4294967296};function Ki(e,n,t){return t||(t=n,n={}),typeof t!="function"&&B(7),Yi(e,n,[zi],function(r){return Qn(an(r.data[0],Jn(r.data[1])))},1,t)}function an(e,n){return Xn(e,{i:2},n&&n.out,n&&n.dictionary)}var ln=typeof TextDecoder<"u"&&new TextDecoder,qi=0;try{ln.decode(Vi,{stream:!0}),qi=1}catch{}var Xi=function(e){for(var n="",t=0;;){var r=e[t++],i=(r>127)+(r>223)+(r>239);if(t+i>e.length)return{s:n,r:He(e,t-1)};i?i==3?(r=((r&15)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,n+=String.fromCharCode(55296|r>>10,56320|r&1023)):i&1?n+=String.fromCharCode((r&31)<<6|e[t++]&63):n+=String.fromCharCode((r&15)<<12|(e[t++]&63)<<6|e[t++]&63):n+=String.fromCharCode(r)}};function Zi(e,n){if(n){for(var t="",r=0;r<e.length;r+=16384)t+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return t}else{if(ln)return ln.decode(e);var i=Xi(e),s=i.s,t=i.r;return t.length&&B(8),s}}var Qi=function(e,n){return n+30+te(e,n+26)+te(e,n+28)},Ji=function(e,n,t){var r=te(e,n+28),i=Zi(e.subarray(n+46,n+46+r),!(te(e,n+8)&2048)),s=n+46+r,o=ee(e,n+20),a=t&&o==4294967295?er(e,s):[o,ee(e,n+24),ee(e,n+42)],l=a[0],c=a[1],u=a[2];return[te(e,n+10),l,c,i,s+te(e,n+30)+te(e,n+32),u]},er=function(e,n){for(;te(e,n)!=1;n+=4+te(e,n+2));return[on(e,n+12),on(e,n+4),on(e,n+20)]},et=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function nr(e,n,t){t||(t=n,n={}),typeof t!="function"&&B(7);var r=[],i=function(){for(var S=0;S<r.length;++S)r[S]()},s={},o=function(S,w){et(function(){t(S,w)})};et(function(){o=t});for(var a=e.length-22;ee(e,a)!=101010256;--a)if(!a||e.length-a>65558)return o(B(13,0,1),null),i;var l=te(e,a+8);if(l){var c=l,u=ee(e,a+16),f=u==4294967295||c==65535;if(f){var p=ee(e,a-12);f=ee(e,p)==101075792,f&&(c=l=ee(e,p+32),u=ee(e,p+48))}for(var d=n&&n.filter,m=function(S){var w=Ji(e,u,f),g=w[0],_=w[1],I=w[2],x=w[3],j=w[4],Y=w[5],K=Qi(e,Y);u=j;var D=function(E,k){E?(i(),o(E,null)):(k&&(s[x]=k),--l||o(null,s))};if(!d||d({name:x,size:_,originalSize:I,compression:g}))if(!g)D(null,He(e,K,K+_));else if(g==8){var Z=e.subarray(K,K+_);if(I<524288||_>.8*I)try{D(null,an(Z,{out:new N(I)}))}catch(E){D(E,null)}else r.push(Ki(Z,{size:I},D))}else D(B(14,"unknown compression type "+g,1),null);else D(null,null)},h=0;h<c;++h)m(h)}else o(null,{});return i}const ne=512,tr=31,ir=139,cn=50*1024*1024,rr=new Set([".png",".jpg",".jpeg",".gif",".webp",".ico",".svg",".bmp",".mp4",".webm",".avi",".mov",".mp3",".wav",".ogg",".woff",".woff2",".ttf",".otf",".eot",".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".exe",".dll",".so",".dylib",".o",".a",".class",".pyc",".pyo",".wasm",".db",".sqlite",".sqlite3",".rpm",".deb",".dmg",".iso"]);function un(e){const n=e.toLowerCase(),t=n.lastIndexOf(".");return t===-1?!1:rr.has(n.slice(t))}async function nt(e,n=""){const t=e instanceof File?new Uint8Array(await e.arrayBuffer()):e;if(st(t))return ot(t,n);const r=pr(t)?await sr(t,n):lr(t,n);return tt(r)}async function tt(e){const n=[];for(const t of e)if(Ve(t.path))try{const r=dr(t.path),i=st(t.rawBytes)?await ot(t.rawBytes,r):await nt(t.rawBytes,r);n.push(...i)}catch{n.push(t)}else n.push(t);return n}async function sr(e,n){const i=new ReadableStream({start(o){o.enqueue(e),o.close()}}).pipeThrough(new DecompressionStream("gzip")).getReader(),s=new or(i);return ar(s,n)}class or{constructor(n){ge(this,"reader");ge(this,"buffer",new Uint8Array(0));ge(this,"eof",!1);this.reader=n}async readExact(n){if(this.buffer.byteLength>=n){const a=this.buffer.slice(0,n);return this.buffer=this.buffer.subarray(n),a}const t=[this.buffer];let r=this.buffer.byteLength;for(this.buffer=new Uint8Array(0);r<n&&!this.eof;){const{done:a,value:l}=await this.reader.read();if(a){this.eof=!0;break}t.push(l),r+=l.byteLength}if(r<n)return null;const i=new Uint8Array(r);let s=0;for(const a of t)i.set(a,s),s+=a.byteLength;const o=i.slice(0,n);return r>n&&(this.buffer=i.subarray(n)),o}async skip(n){let t=n;if(this.buffer.byteLength>0){if(this.buffer.byteLength>=t){this.buffer=this.buffer.subarray(t);return}t-=this.buffer.byteLength,this.buffer=new Uint8Array(0)}for(;t>0&&!this.eof;){const{done:r,value:i}=await this.reader.read();if(r){this.eof=!0;break}i.byteLength>t?(this.buffer=i.subarray(t),t=0):t-=i.byteLength}}}async function ar(e,n){const t=[],r=new TextDecoder("utf-8",{fatal:!1});let i="";for(;;){const s=await e.readExact(ne);if(!s)break;if(Be(s)){const a=await e.readExact(ne);if(!a||Be(a))break;const l=await it(a,e,r,n,i);l==="longname"?i=await rt(e,a,r):(l&&t.push(l),i="");continue}const o=await it(s,e,r,n,i);o==="longname"?i=await rt(e,s,r):(o&&t.push(o),i="")}return t}async function it(e,n,t,r,i){const s=ae(e,0,100),o=ae(e,124,12),a=ae(e,156,1),l=ae(e,345,155),c=fn(o),u=xe(c);if(a==="L")return"longname";let f=i||(l?`${l}/${s}`:s);f=f.replace(/\0+$/,"");const p=r?`${r}/${f}`:f;if(a==="5"||f.endsWith("/")||c===0||a!=="0"&&a!==""&&a!=="\0")return await n.skip(u),null;if(c>cn)return await n.skip(u),null;if(!Ve(p)&&un(p))return await n.skip(u),null;const d=await n.readExact(u);if(!d)return null;const m=d.slice(0,c),h=t.decode(m);return{path:p,content:h,rawBytes:m}}async function rt(e,n,t){const r=ae(n,124,12),i=fn(r),s=xe(i),o=await e.readExact(s);return o?t.decode(o.subarray(0,i)).replace(/\0+$/,""):""}function lr(e,n){const t=[];let r=0;const i=new TextDecoder("utf-8",{fatal:!1});let s="";for(;r+ne<=e.length;){const o=e.subarray(r,r+ne);if(Be(o)){if(r+2*ne<=e.length&&Be(e.subarray(r+ne,r+2*ne)))break;r+=ne;continue}const a=ae(o,0,100),l=ae(o,124,12),c=ae(o,156,1),u=ae(o,345,155),f=fn(l);if(r+=ne,c==="L"){const S=e.subarray(r,r+f);s=i.decode(S).replace(/\0+$/,""),r+=xe(f);continue}let p=s||(u?`${u}/${a}`:a);s="",p=p.replace(/\0+$/,"");const d=n?`${n}/${p}`:p;if(c==="5"||p.endsWith("/")||f===0||c!=="0"&&c!==""&&c!=="\0"||f>cn||!Ve(d)&&un(d)){r+=xe(f);continue}const m=e.slice(r,r+f),h=i.decode(m);t.push({path:d,content:h,rawBytes:m}),r+=xe(f)}return t}const cr=80,ur=75;function st(e){return e.length>=4&&e[0]===cr&&e[1]===ur&&(e[2]===3||e[2]===5||e[2]===7)&&(e[3]===4||e[3]===6||e[3]===8)}function fr(e){return new Promise((n,t)=>{nr(e,(r,i)=>{r?t(r):n(i)})})}async function ot(e,n=""){const t=e instanceof File?new Uint8Array(await e.arrayBuffer()):e,r=await fr(t),i=new TextDecoder("utf-8",{fatal:!1}),s=[];for(const[o,a]of Object.entries(r)){if(o.endsWith("/")||a.length===0||a.length>cn)continue;const l=n?`${n}/${o}`:o;if(!Ve(l)&&un(o))continue;const c=i.decode(a);s.push({path:l,content:c,rawBytes:a})}return tt(s)}function pr(e){return e.length>=2&&e[0]===tr&&e[1]===ir}function Be(e){for(let n=0;n<e.length;n++)if(e[n]!==0)return!1;return!0}function ae(e,n,t){let r=n+t;for(;r>n&&e[r-1]===0;)r--;const i=e.subarray(n,r);return new TextDecoder("ascii").decode(i)}function fn(e){const n=e.trim();return n&&parseInt(n,8)||0}function xe(e){return Math.ceil(e/ne)*ne}function Ve(e){const n=e.toLowerCase();return n.endsWith(".tar")||n.endsWith(".tar.gz")||n.endsWith(".tgz")||n.endsWith(".zip")}function dr(e){const n=e.toLowerCase();return n.endsWith(".tar.gz")?e.slice(0,-7):n.endsWith(".tgz")||n.endsWith(".tar")||n.endsWith(".zip")?e.slice(0,-4):e}const O={Unknown:"Unknown",Warm:"Warm",Cold:"Cold",OnlyConversion:"OnlyConversion"},y={Pending:"Pending",Ready:"Ready",Running:"Running",Succeeded:"Succeeded",Failed:"Failed"},F={Unknown:"Unknown",Initialize:"Initialize",PreflightInspection:"PreflightInspection",DiskAllocation:"DiskAllocation",DiskTransfer:"DiskTransfer",DiskTransferV2v:"DiskTransferV2v",Cutover:"Cutover",ImageConversion:"ImageConversion",VMCreation:"VMCreation"},v={Started:"Started",PreHook:"PreHook",PostHook:"PostHook",Completed:"Completed",AddCheckpoint:"AddCheckpoint",AddFinalCheckpoint:"AddFinalCheckpoint",AllocateDisks:"AllocateDisks",ConvertGuest:"ConvertGuest",ConvertOpenstackSnapshot:"ConvertOpenstackSnapshot",CopyDisks:"CopyDisks",CopyDisksVirtV2V:"CopyDisksVirtV2V",CopyingPaused:"CopyingPaused",CreateDataVolumes:"CreateDataVolumes",CreateFinalSnapshot:"CreateFinalSnapshot",CreateGuestConversionPod:"CreateGuestConversionPod",CreateInitialSnapshot:"CreateInitialSnapshot",CreateSnapshot:"CreateSnapshot",CreateVM:"CreateVM",Finalize:"Finalize",PreflightInspection:"PreflightInspection",PowerOffSource:"PowerOffSource",RemoveFinalSnapshot:"RemoveFinalSnapshot",RemovePenultimateSnapshot:"RemovePenultimateSnapshot",RemovePreviousSnapshot:"RemovePreviousSnapshot",StoreInitialSnapshotDeltas:"StoreInitialSnapshotDeltas",StorePowerState:"StorePowerState",StoreSnapshotDeltas:"StoreSnapshotDeltas",WaitForDataVolumesStatus:"WaitForDataVolumesStatus",WaitForFinalSnapshot:"WaitForFinalSnapshot",WaitForFinalSnapshotRemoval:"WaitForFinalSnapshotRemoval",WaitForInitialSnapshot:"WaitForInitialSnapshot",WaitForPenultimateSnapshotRemoval:"WaitForPenultimateSnapshotRemoval",WaitForPowerOff:"WaitForPowerOff",WaitForPreviousSnapshotRemoval:"WaitForPreviousSnapshotRemoval",WaitForSnapshot:"WaitForSnapshot"},mr=[v.CopyDisks,v.CopyingPaused,v.RemovePreviousSnapshot,v.WaitForPreviousSnapshotRemoval,v.CreateSnapshot,v.WaitForSnapshot,v.StoreSnapshotDeltas,v.AddCheckpoint],pn=new Set(mr),at=v.CopyDisks,hr=new Set([v.CreateInitialSnapshot,v.WaitForInitialSnapshot,v.StoreInitialSnapshotDeltas,v.WaitForDataVolumesStatus,v.CopyingPaused,v.RemovePreviousSnapshot,v.WaitForPreviousSnapshotRemoval,v.CreateSnapshot,v.WaitForSnapshot,v.StoreSnapshotDeltas,v.AddCheckpoint,v.RemovePenultimateSnapshot,v.WaitForPenultimateSnapshotRemoval,v.CreateFinalSnapshot,v.WaitForFinalSnapshot,v.AddFinalCheckpoint,v.Finalize,v.RemoveFinalSnapshot,v.WaitForFinalSnapshotRemoval]),gr=new Set([v.CopyDisks,v.AllocateDisks,v.CopyDisksVirtV2V]);function dn(e,n){switch(e){case v.Started:case v.CreateInitialSnapshot:case v.WaitForInitialSnapshot:case v.StoreInitialSnapshotDeltas:return F.Initialize;case v.AllocateDisks:return F.DiskAllocation;case v.CopyDisks:case v.CopyingPaused:case v.RemovePreviousSnapshot:case v.WaitForPreviousSnapshotRemoval:case v.CreateSnapshot:case v.WaitForSnapshot:case v.StoreSnapshotDeltas:case v.AddCheckpoint:case v.ConvertOpenstackSnapshot:return F.DiskTransfer;case v.CreateDataVolumes:case v.WaitForDataVolumesStatus:return F.Initialize;case v.RemovePenultimateSnapshot:case v.WaitForPenultimateSnapshotRemoval:case v.CreateFinalSnapshot:case v.WaitForFinalSnapshot:case v.AddFinalCheckpoint:case v.Finalize:case v.RemoveFinalSnapshot:case v.WaitForFinalSnapshotRemoval:return F.Cutover;case v.CreateGuestConversionPod:case v.ConvertGuest:return F.ImageConversion;case v.CopyDisksVirtV2V:return F.DiskTransferV2v;case v.CreateVM:return F.VMCreation;case v.PreHook:case v.PostHook:return e;case v.StorePowerState:case v.PowerOffSource:case v.WaitForPowerOff:return n?F.Cutover:F.Initialize;case v.PreflightInspection:return F.PreflightInspection;case v.Completed:return F.VMCreation;default:return F.Unknown}}const fe={True:"True"},vr="panic:",Sr=/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z)\s+(\{.*)$/,Cr=/id:(vm-\d+)\s+name:'([^']+)'/;function wr(e){if(!e)return new Date(0);let n=new Date(e);if(!isNaN(n.getTime()))return n;const t=e.match(/^(\d{4}-\d{2}-\d{2})\s+(\d{2}:\d{2}:\d{2})(?:\.(\d+))?$/);if(t){const[,r,i,s]=t,o=`${r}T${i}${s?`.${s}`:""}Z`;if(n=new Date(o),!isNaN(n.getTime()))return n}return new Date(0)}function kr(e){const n=e.match(Cr);return n&&n.length>=3?{id:n[1],name:n[2]}:{id:"",name:""}}function ie(e){var n;if((n=e.vmRef)!=null&&n.id)return{id:e.vmRef.id,name:e.vmRef.name||""};if(e.vm){if(typeof e.vm=="string")return kr(e.vm);const t=e.vm;return{id:t.id||"",name:t.name||""}}return{id:"",name:""}}function mn(e,n){return e.length<=n?e:e.slice(0,n)+"..."}function Le(e,n){if(!e)return"";const t=e[n];return typeof t=="string"?t:""}function Ue(e){if(e<1e3)return`${e}ms`;if(e<6e4)return`${(e/1e3).toFixed(1)}s`;if(e<36e5){const r=Math.floor(e/6e4),i=Math.floor(e%6e4/1e3);return`${r}m ${i}s`}const n=Math.floor(e/36e5),t=Math.floor(e%36e5/6e4);return`${n}h ${t}m`}function lt(e){let n=!1,t=!1,r=!1;for(const i of e)hr.has(i.name)&&(n=!0),gr.has(i.name)&&(t=!0),(i.name===v.CreateGuestConversionPod||i.name===v.ConvertGuest)&&(r=!0);return n?O.Warm:r&&!t?O.OnlyConversion:t||e.length>0?O.Cold:O.Unknown}function ct(e){const n=new Map,t=[];for(const r of e){const i=n.get(r.message);i?(i.count++,i.lastSeen=r.timestamp,i.entries.push(r)):(n.set(r.message,{message:r.message,count:1,firstSeen:r.timestamp,lastSeen:r.timestamp,level:r.level,entries:[r]}),t.push(r.message))}return t.map(r=>n.get(r))}function yr(e){if(!e.phaseLogs)return{};const n={},t=new Map;for(const r of e.phaseHistory)t.set(r.name,r);for(const[r,i]of Object.entries(e.phaseLogs)){if(i.length===0)continue;const s={phase:r,totalLogs:i.length,groupedLogs:ct(i)},o=t.get(r);if(o&&(o.startedAt&&(s.startTime=o.startedAt.toISOString()),o.endedAt&&(s.endTime=o.endedAt.toISOString(),o.startedAt))){const a=o.endedAt.getTime()-o.startedAt.getTime();s.durationMs=a,s.duration=Ue(a)}n[r]=s}return n}function Ar(e){const n=new Map;for(const o of e)if(pn.has(o.name)&&o.iteration){const a=n.get(o.iteration)||[];a.push(o),n.set(o.iteration,a)}if(n.size===0)return;const t=[];let r=0,i=0;const s=Array.from(n.entries()).sort((o,a)=>o[0]-a[0]);for(const[o,a]of s){let l,c,u=!0;for(const m of a)m.startedAt&&(!l||m.startedAt<l)&&(l=m.startedAt),m.endedAt?(!c||m.endedAt>c)&&(c=m.endedAt):u=!1;const f=l&&c?c.getTime()-l.getTime():void 0,p=a.some(m=>m.name===v.AddCheckpoint&&m.endedAt),d=a.some(m=>m.name===at&&m.startedAt);p?r++:d&&!u&&s.some(([h])=>h>o)&&i++,t.push({iteration:o,snapshot:`iteration-${o}`,startedAt:l,endedAt:c,durationMs:f,disks:[]})}return{precopies:t,successes:r,failures:i,consecutiveFailures:0}}function _r(e){return e.startsWith("panic:")||e.startsWith("goroutine ")}class br{constructor(){ge(this,"plans",new Map);ge(this,"events",[]);ge(this,"stats",{totalLines:0,parsedLines:0,errorLines:0,duplicateLines:0,plansFound:0,vmsFound:0});ge(this,"processedLines",new Set)}isLineProcessed(n){return this.processedLines.has(n)}markLineProcessed(n){this.processedLines.add(n)}getOrCreatePlan(n,t){const r=`${n}/${t}`;let i=this.plans.get(r);return i||(i={name:t,namespace:n,status:y.Pending,archived:!1,migrationType:O.Unknown,conditions:[],vms:{},errors:[],panics:[],firstSeen:new Date(0),lastSeen:new Date(0)},this.plans.set(r,i)),i}findPlan(n){return this.plans.get(n)}getMostRecentPlan(){let n;for(const t of this.plans.values())(!n||t.lastSeen>n.lastSeen)&&(n=t);return n}addEvent(n){this.events.push(n)}updateStats(n){Object.assign(this.stats,n)}incrementStat(n){this.stats[n]++}getAllPlans(){const n=[];for(const t of this.plans.values()){for(const r of Object.values(t.vms)){r.phaseLogSummaries=yr(r),r.migrationType=lt(r.phaseHistory);const i=r.migrationType===O.Warm;if(r.currentPhase&&(r.currentStep=dn(r.currentPhase,i)),i&&!r.warmInfo){const s=Ar(r.phaseHistory);s&&(r.warmInfo=s,r.precopyCount=s.precopies.length)}for(const s of r.phaseHistory)s.step=dn(s.name,i)}t.migrationType=this.detectPlanMigrationType(t),n.push(t)}return n}detectPlanMigrationType(n){let t=!1,r=!1,i=!1;for(const s of Object.values(n.vms))switch(lt(s.phaseHistory)){case O.Warm:t=!0;break;case O.Cold:r=!0;break;case O.OnlyConversion:i=!0;break}return t?O.Warm:r?O.Cold:i?O.OnlyConversion:O.Unknown}getEvents(){return this.events}getSummary(){const n={totalPlans:this.plans.size,running:0,succeeded:0,failed:0,archived:0,pending:0};for(const t of this.plans.values())switch(t.archived&&n.archived++,t.status){case y.Running:n.running++;break;case y.Succeeded:n.succeeded++;break;case y.Failed:n.failed++;break;case y.Pending:case y.Ready:n.pending++;break}return n}getStats(){this.stats.plansFound=this.plans.size;let n=0;for(const t of this.plans.values())n+=Object.keys(t.vms).length;return this.stats.vmsFound=n,this.stats}getResult(){return{plans:this.getAllPlans(),events:this.events,summary:this.getSummary(),stats:this.getStats(),networkMaps:[],storageMaps:[]}}clear(){this.plans.clear(),this.events=[],this.stats={totalLines:0,parsedLines:0,errorLines:0,duplicateLines:0,plansFound:0,vmsFound:0},this.processedLines.clear()}}function ut(e,n,t){return{id:e,name:n,currentPhase:"",currentStep:"",migrationType:O.Unknown,transferMethod:"Unknown",phaseHistory:[],dataVolumes:[],createdResources:[],phaseLogs:{},firstSeen:t,lastSeen:t}}function Ir(e,n,t){var l,c;const r=((l=n.plan)==null?void 0:l.name)||"",i=((c=n.plan)==null?void 0:c.namespace)||"";if(!r||!i)return;const s=e.getOrCreatePlan(i,r),o=n.msg||"";if(n.migration&&s.migration&&n.migration!==s.migration&&o!=="Migration [STARTED]")return;s.firstSeen.getTime()===0&&(s.firstSeen=t),s.lastSeen=t;const{id:a}=ie(n);if(a&&Er(s,n,t),o.includes("Aborting reconcile of archived plan")){s.archived=!0;return}if(o.includes("Skipping reconcile of succeeded plan")){s.status=y.Succeeded;return}if(o==="Migration [STARTED]"){n.migration&&s.migration&&n.migration!==s.migration&&(s.vms={},s.errors=[],s.panics=[],s.conditions=[],s.firstSeen=t),s.status=y.Running,n.migration&&(s.migration=n.migration),e.addEvent({timestamp:n.ts,type:"migration_start",planName:r,namespace:i,description:"Migration started"});return}if(o==="Migration [SUCCEEDED]"){s.status=y.Succeeded;for(const u of Object.values(s.vms))if(u.currentPhase!==v.Completed){if(u.phaseHistory.length>0){const f=u.phaseHistory[u.phaseHistory.length-1];f.endedAt||(f.endedAt=t)}u.currentPhase=v.Completed,u.phaseHistory.push({name:v.Completed,step:"",startedAt:t,endedAt:t})}e.addEvent({timestamp:n.ts,type:"migration_succeeded",planName:r,namespace:i,description:"Migration succeeded"});return}if(o==="Migration [RUN]"&&a){Lr(e,s,n,t),hn(s,n);return}if(o==="SetCheckpoint"&&a){Fr(s,n),hn(s,n);return}if(o==="Itinerary transition"){Rr(e,s,n,t);return}if(o.startsWith("Condition added")){Nr(e,s,n,t);return}if(o.startsWith("Condition deleted")){Tr(s,n);return}if(Wr(n)&&Hr(s,n),o==="Created DataVolume."&&n.dv){Mr(s,n,t);return}if(o.includes("created.")||o.startsWith("Created ")){Pr(s,n,t,o);return}if(n.level==="error"&&n.error){Or(e,s,r,i,n,t);return}if(o.includes("Found (active) migration")){s.status=y.Running,n.migration&&(s.migration=n.migration);return}n.err&&Dr(e,s,r,i,n,t),a&&hn(s,n)}function Er(e,n,t){const{id:r,name:i}=ie(n);if(!r)return;let s=e.vms[r];s||(s=ut(r,i,t),e.vms[r]=s),s.lastSeen=t,n.phase&&!s.currentPhase&&(s.currentPhase=n.phase,s.phaseHistory.push({name:n.phase,step:"",startedAt:t}))}function xr(e){let n=0;for(const t of e.phaseHistory)pn.has(t.name)&&t.iteration&&(n=Math.max(n,t.iteration));return n}function Lr(e,n,t,r){const{id:i,name:s}=ie(t);if(!i)return;let o=n.vms[i];if(o||(o=ut(i,s,r),n.vms[i]=o),o.lastSeen=r,t.phase&&t.phase!==o.currentPhase){if(o.phaseHistory.length>0){const c=o.phaseHistory[o.phaseHistory.length-1];c.endedAt||(c.endedAt=r)}let a;if(pn.has(t.phase)){const c=xr(o);t.phase===at?a=c+1:a=c||1}o.currentPhase=t.phase,o.phaseHistory.push({name:t.phase,step:"",startedAt:r,iteration:a});const l=a?` (iteration ${a})`:"";e.addEvent({timestamp:t.ts,type:"phase_change",planName:n.name,namespace:n.namespace,vmName:s,description:`VM entered phase: ${t.phase}${l}`,phase:t.phase})}t.phase===v.Completed&&(n.status=y.Succeeded)}function Fr(e,n,t){const{id:r}=ie(n);if(!r)return;const i=e.vms[r];if(!i)return;const s=n,o=s.precopies;if(!o||o.length===0)return;const a=o.map((d,m)=>{const h=d.start?new Date(d.start):void 0,S=d.end?new Date(d.end):void 0,w=h&&S?S.getTime()-h.getTime():void 0;return{iteration:m+1,snapshot:d.snapshot||"unknown",startedAt:h,endedAt:S,durationMs:w,disks:(d.deltas||[]).map(g=>g.disk||"").filter(Boolean)}}),l=a.filter(d=>d.endedAt).length,u=a.length-l-(a.some(d=>!d.endedAt)?1:0),f=s.final===!0,p={precopies:a,successes:l,failures:u>0?u:0,consecutiveFailures:0};i.warmInfo=p,i.precopyCount=a.length,i.migrationType==="Unknown"&&(i.migrationType="Warm"),f&&(i.warmInfo.consecutiveFailures=0)}function Rr(e,n,t,r){const i=t["current phase"],s=t["next phase"];if(!(!i||!s)&&(e.addEvent({timestamp:t.ts,type:"phase_transition",planName:n.name,namespace:n.namespace,description:`${i} → ${s}`,phase:s}),s===v.Completed)){for(const o of Object.values(n.vms))if(o.currentPhase!==v.Completed){if(o.phaseHistory.length>0){const a=o.phaseHistory[o.phaseHistory.length-1];a.endedAt||(a.endedAt=r)}o.currentPhase=v.Completed,o.phaseHistory.push({name:v.Completed,step:"",startedAt:r,endedAt:r})}n.status=y.Succeeded}}function Nr(e,n,t,r){if(!t.condition)return;const i=Le(t.condition,"type"),s=Le(t.condition,"status"),o=Le(t.condition,"message"),a=Le(t.condition,"category"),l={type:i,status:s,category:a,message:o,timestamp:r};i==="Executing"&&s===fe.True?n.status=y.Running:i==="Ready"&&s===fe.True&&n.status===y.Pending?n.status=y.Ready:i==="Succeeded"&&s===fe.True?n.status=y.Succeeded:i==="Failed"&&s===fe.True&&(n.status=y.Failed);const c=n.conditions.findIndex(u=>u.type===i);c>=0?n.conditions[c]=l:n.conditions.push(l),e.addEvent({timestamp:t.ts,type:"condition",planName:n.name,namespace:n.namespace,description:`${i}: ${o}`})}function Tr(e,n){if(!n.condition)return;const t=Le(n.condition,"type");e.conditions=e.conditions.filter(r=>r.type!==t)}function Mr(e,n,t){const{id:r}=ie(n);if(!r)return;const i=e.vms[r];if(!i)return;i.dataVolumes.push({name:n.dv,createdAt:t});const s={timestamp:n.ts,level:n.level,message:`${n.msg} (${n.dv})`,phase:"CreateDataVolumes",rawLine:n.rawLine||""};i.phaseLogs.CreateDataVolumes||(i.phaseLogs.CreateDataVolumes=[]),i.phaseLogs.CreateDataVolumes.push(s)}function Pr(e,n,t,r){var u;const{id:i}=ie(n);if(!i)return;const s=e.vms[i];if(!s)return;let o="",a="";const l=n;if(r==="Secret created."&&l.secret)o="Secret",a=l.secret;else if(r==="ConfigMap created."&&l.configMap)o="ConfigMap",a=l.configMap;else if(r==="Pod created."&&l.pod)o="Pod",a=l.pod;else if(r==="VirtualMachine created."&&l.virtualMachine)o="VirtualMachine",a=l.virtualMachine;else if(r==="PVC created."&&l.pvc)o="PVC",a=l.pvc;else{const f=r.match(/^Created (\w+)\.?$/);if(f){if(o=f[1],o==="DataVolume")return;(u=n.object)!=null&&u.name&&(a=n.object.namespace?`${n.object.namespace}/${n.object.name}`:n.object.name)}}if(!o)return;s.createdResources.some(f=>f.type===o&&f.name===a)||s.createdResources.push({type:o,name:a,createdAt:t})}function Or(e,n,t,r,i,s){var u;const o=i.msg||"";if((u=i.error)!=null&&u.includes("connection refused"))return;o.includes("Reconcile failed")&&(n.status=y.Failed);const{name:a}=ie(i);let l=o;a&&(l=`[${a}] ${o}`);const c=n.errors.findIndex(f=>f.error===i.error&&f.message===l);c>=0?(n.errors[c].count++,n.errors[c].timestamp=s):n.errors.push({timestamp:s,message:l,error:i.error||"",stacktrace:i.stacktrace,rawLine:i.rawLine,count:1,level:"error"}),e.addEvent({timestamp:i.ts,type:"error",planName:t,namespace:r,vmName:a,description:mn(`${l}: ${i.error}`,150)})}function Dr(e,n,t,r,i,s){const{name:o}=ie(i),a=i.err||"";let l=i.msg||"";o&&(l=`[${o}] ${i.msg}`);const c=n.errors.findIndex(u=>u.error===a);c>=0?(n.errors[c].count++,n.errors[c].timestamp=s):n.errors.push({timestamp:s,message:l,error:a,rawLine:i.rawLine,count:1,level:"warning"}),e.addEvent({timestamp:i.ts,type:"warning",planName:t,namespace:r,vmName:o,description:mn(`${l}: ${a}`,150)})}function hn(e,n){const{id:t}=ie(n);if(!t)return;const r=e.vms[t];if(!r||!r.currentPhase)return;const i=n.phase||r.currentPhase,s={timestamp:n.ts,level:n.level,message:n.msg||"",phase:i,rawLine:n.rawLine||""};r.phaseLogs[i]||(r.phaseLogs[i]=[]),r.phaseLogs[i].push(s)}function Wr(e){const n=e.msg||"",t=e.rawLine||"";return!!(t.includes("VSphereXcopy")||t.includes("copy-offload")||t.includes("xcopy-initial-offload")||n==="Creating the populator resource"||n.includes("populator CR")||n.includes("Populator CR"))}function Hr(e,n){const{id:t}=ie(n);if(t){const r=e.vms[t];r&&(r.transferMethod="StorageOffload")}}function $r(e,n,t){var c,u,f,p;const r=((c=n.object)==null?void 0:c.name)||"",i=((u=n.object)==null?void 0:u.namespace)||"";if(!r||!i)return;const s=e.getOrCreatePlan(i,r);s.status=y.Failed;let o=n.panic||"";if(!o){o=n.msg||"";const d=o.indexOf(": ");d>0&&(o=o.slice(d+2))}const a=n.stacktrace||"",l=s.panics.findIndex(d=>d.message===o);l>=0?(s.panics[l].count++,s.panics[l].timestamp=t,(f=s.panics[l].rawLines)==null||f.push(n.rawLine||""),a&&a.length>(((p=s.panics[l].stacktrace)==null?void 0:p.length)||0)&&(s.panics[l].stacktrace=a)):s.panics.push({timestamp:t,message:o,controller:n.controller,reconcileId:n.reconcileID,stacktrace:a,rawLines:n.rawLine?[n.rawLine]:[],count:1}),e.addEvent({timestamp:n.ts,type:"panic",planName:r,namespace:i,description:`Panic: ${mn(o,100)}`})}function Br(e,n,t){var o,a,l,c;const r=((o=n.object)==null?void 0:o.name)||"",i=((a=n.object)==null?void 0:a.namespace)||"";if(!r||!i)return;const s=e.getOrCreatePlan(i,r);if((l=n.error)!=null&&l.includes(vr)){s.status=y.Failed;let u=n.error;const f=u.indexOf("panic: ");if(f>=0){u=u.slice(f+7);const p=u.indexOf(" [recovered]");p>0&&(u=u.slice(0,p))}for(let p=0;p<s.panics.length;p++){const d=s.panics[p];if(d.message.includes(u)||u.includes(d.message)){(c=s.panics[p].rawLines)==null||c.push(n.rawLine||""),n.stacktrace&&n.stacktrace!==d.stacktrace&&(d.stacktrace?s.panics[p].stacktrace=`${d.stacktrace}

--- Recovery Stacktrace ---
${n.stacktrace}`:s.panics[p].stacktrace=n.stacktrace);return}}s.panics.push({timestamp:t,message:u,controller:n.controller,reconcileId:n.reconcileID,stacktrace:n.stacktrace,rawLines:n.rawLine?[n.rawLine]:[],count:1})}}function ft(e,n){if(!e||n.length===0)return;const t=n.join(`
`);if(e.panics.length>0){const r=e.panics.length-1;e.panics[r].stacktrace=t,e.panics[r].rawLines=[...e.panics[r].rawLines||[],...n]}else{let r="Unknown panic";n.length>0&&n[0].startsWith("panic: ")&&(r=n[0].slice(7)),e.panics.push({timestamp:e.lastSeen,message:r,stacktrace:t,rawLines:n,count:1}),e.status=y.Failed}}function pt(e){const n=new br,t=e.split(`
`);let r,i=[],s=!1;for(const o of t){if(n.incrementStat("totalLines"),!o.trim())continue;if(n.isLineProcessed(o)){n.incrementStat("duplicateLines");continue}let a=o,l="";const c=o.match(Sr);c&&(l=c[1],a=c[2]);let u;try{const f=JSON.parse(a);if(typeof f!="object"||f===null||Array.isArray(f)){n.incrementStat("errorLines");continue}u=f}catch{(s||_r(o))&&(s=!0,i.push(o),o.startsWith("panic:")&&!r&&(r=n.getMostRecentPlan())),n.incrementStat("errorLines");continue}!u.ts&&l&&(u.ts=l),s&&r&&i.length>0&&(ft(r,i),i=[],r=void 0,s=!1),u.rawLine=o,n.markLineProcessed(o),n.incrementStat("parsedLines"),Vr(n,u)}return s&&r&&i.length>0&&ft(r,i),n.getResult()}function Vr(e,n){var r,i,s,o;const t=wr(n.ts);if((r=n.msg)!=null&&r.includes("Observed a panic")){$r(e,n,t);return}if(n.msg==="Reconciler error"&&n.controller){Br(e,n,t);return}if((i=n.logger)!=null&&i.startsWith("plan|")){Ir(e,n,t);return}if((s=n.msg)!=null&&s.includes("scheduler")||(o=n.logger)!=null&&o.includes("scheduler")){Ur(e,n,t);return}}function Ur(e,n,t){var c;const r=n,i=r.inflight,s=r.pending;if(!i&&!s)return;const o={timestamp:t.toISOString(),inflight:i||{},pending:s||{}},a=r.next;a&&(o.nextVM=a);const l=(c=n.logger)==null?void 0:c.split("|");if(l&&l.length>=2){const u=l[1],f=e.findPlan(u);f&&(f.scheduleHistory||(f.scheduleHistory=[]),f.scheduleHistory.push(o))}}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function dt(e){return typeof e>"u"||e===null}function Gr(e){return typeof e=="object"&&e!==null}function jr(e){return Array.isArray(e)?e:dt(e)?[]:[e]}function zr(e,n){var t,r,i,s;if(n)for(s=Object.keys(n),t=0,r=s.length;t<r;t+=1)i=s[t],e[i]=n[i];return e}function Yr(e,n){var t="",r;for(r=0;r<n;r+=1)t+=e;return t}function Kr(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var qr=dt,Xr=Gr,Zr=jr,Qr=Yr,Jr=Kr,es=zr,P={isNothing:qr,isObject:Xr,toArray:Zr,repeat:Qr,isNegativeZero:Jr,extend:es};function mt(e,n){var t="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(t+='in "'+e.mark.name+'" '),t+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!n&&e.mark.snippet&&(t+=`

`+e.mark.snippet),r+" "+t):r}function Fe(e,n){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=n,this.message=mt(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Fe.prototype=Object.create(Error.prototype),Fe.prototype.constructor=Fe,Fe.prototype.toString=function(n){return this.name+": "+mt(this,n)};var V=Fe;function gn(e,n,t,r,i){var s="",o="",a=Math.floor(i/2)-1;return r-n>a&&(s=" ... ",n=r-a+s.length),t-r>a&&(o=" ...",t=r+a-o.length),{str:s+e.slice(n,t).replace(/\t/g,"→")+o,pos:r-n+s.length}}function vn(e,n){return P.repeat(" ",n-e.length)+e}function ns(e,n){if(n=Object.create(n||null),!e.buffer)return null;n.maxLength||(n.maxLength=79),typeof n.indent!="number"&&(n.indent=1),typeof n.linesBefore!="number"&&(n.linesBefore=3),typeof n.linesAfter!="number"&&(n.linesAfter=2);for(var t=/\r?\n|\r|\0/g,r=[0],i=[],s,o=-1;s=t.exec(e.buffer);)i.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var a="",l,c,u=Math.min(e.line+n.linesAfter,i.length).toString().length,f=n.maxLength-(n.indent+u+3);for(l=1;l<=n.linesBefore&&!(o-l<0);l++)c=gn(e.buffer,r[o-l],i[o-l],e.position-(r[o]-r[o-l]),f),a=P.repeat(" ",n.indent)+vn((e.line-l+1).toString(),u)+" | "+c.str+`
`+a;for(c=gn(e.buffer,r[o],i[o],e.position,f),a+=P.repeat(" ",n.indent)+vn((e.line+1).toString(),u)+" | "+c.str+`
`,a+=P.repeat("-",n.indent+u+3+c.pos)+`^
`,l=1;l<=n.linesAfter&&!(o+l>=i.length);l++)c=gn(e.buffer,r[o+l],i[o+l],e.position-(r[o]-r[o+l]),f),a+=P.repeat(" ",n.indent)+vn((e.line+l+1).toString(),u)+" | "+c.str+`
`;return a.replace(/\n$/,"")}var ts=ns,is=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],rs=["scalar","sequence","mapping"];function ss(e){var n={};return e!==null&&Object.keys(e).forEach(function(t){e[t].forEach(function(r){n[String(r)]=t})}),n}function os(e,n){if(n=n||{},Object.keys(n).forEach(function(t){if(is.indexOf(t)===-1)throw new V('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=n,this.tag=e,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(t){return t},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=ss(n.styleAliases||null),rs.indexOf(this.kind)===-1)throw new V('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var W=os;function ht(e,n){var t=[];return e[n].forEach(function(r){var i=t.length;t.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=o)}),t[i]=r}),t}function as(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},n,t;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(n=0,t=arguments.length;n<t;n+=1)arguments[n].forEach(r);return e}function Sn(e){return this.extend(e)}Sn.prototype.extend=function(n){var t=[],r=[];if(n instanceof W)r.push(n);else if(Array.isArray(n))r=r.concat(n);else if(n&&(Array.isArray(n.implicit)||Array.isArray(n.explicit)))n.implicit&&(t=t.concat(n.implicit)),n.explicit&&(r=r.concat(n.explicit));else throw new V("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof W))throw new V("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new V("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new V("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof W))throw new V("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Sn.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=ht(i,"implicit"),i.compiledExplicit=ht(i,"explicit"),i.compiledTypeMap=as(i.compiledImplicit,i.compiledExplicit),i};var gt=Sn,vt=new W("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),St=new W("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Ct=new W("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),wt=new gt({explicit:[vt,St,Ct]});function ls(e){if(e===null)return!0;var n=e.length;return n===1&&e==="~"||n===4&&(e==="null"||e==="Null"||e==="NULL")}function cs(){return null}function us(e){return e===null}var kt=new W("tag:yaml.org,2002:null",{kind:"scalar",resolve:ls,construct:cs,predicate:us,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function fs(e){if(e===null)return!1;var n=e.length;return n===4&&(e==="true"||e==="True"||e==="TRUE")||n===5&&(e==="false"||e==="False"||e==="FALSE")}function ps(e){return e==="true"||e==="True"||e==="TRUE"}function ds(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var yt=new W("tag:yaml.org,2002:bool",{kind:"scalar",resolve:fs,construct:ps,predicate:ds,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function ms(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function hs(e){return 48<=e&&e<=55}function gs(e){return 48<=e&&e<=57}function vs(e){if(e===null)return!1;var n=e.length,t=0,r=!1,i;if(!n)return!1;if(i=e[t],(i==="-"||i==="+")&&(i=e[++t]),i==="0"){if(t+1===n)return!0;if(i=e[++t],i==="b"){for(t++;t<n;t++)if(i=e[t],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(t++;t<n;t++)if(i=e[t],i!=="_"){if(!ms(e.charCodeAt(t)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(t++;t<n;t++)if(i=e[t],i!=="_"){if(!hs(e.charCodeAt(t)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;t<n;t++)if(i=e[t],i!=="_"){if(!gs(e.charCodeAt(t)))return!1;r=!0}return!(!r||i==="_")}function Ss(e){var n=e,t=1,r;if(n.indexOf("_")!==-1&&(n=n.replace(/_/g,"")),r=n[0],(r==="-"||r==="+")&&(r==="-"&&(t=-1),n=n.slice(1),r=n[0]),n==="0")return 0;if(r==="0"){if(n[1]==="b")return t*parseInt(n.slice(2),2);if(n[1]==="x")return t*parseInt(n.slice(2),16);if(n[1]==="o")return t*parseInt(n.slice(2),8)}return t*parseInt(n,10)}function Cs(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!P.isNegativeZero(e)}var At=new W("tag:yaml.org,2002:int",{kind:"scalar",resolve:vs,construct:Ss,predicate:Cs,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),ws=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ks(e){return!(e===null||!ws.test(e)||e[e.length-1]==="_")}function ys(e){var n,t;return n=e.replace(/_/g,"").toLowerCase(),t=n[0]==="-"?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),n===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:n===".nan"?NaN:t*parseFloat(n,10)}var As=/^[-+]?[0-9]+e/;function _s(e,n){var t;if(isNaN(e))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(P.isNegativeZero(e))return"-0.0";return t=e.toString(10),As.test(t)?t.replace("e",".e"):t}function bs(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||P.isNegativeZero(e))}var _t=new W("tag:yaml.org,2002:float",{kind:"scalar",resolve:ks,construct:ys,predicate:bs,represent:_s,defaultStyle:"lowercase"}),bt=wt.extend({implicit:[kt,yt,At,_t]}),It=bt,Et=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),xt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Is(e){return e===null?!1:Et.exec(e)!==null||xt.exec(e)!==null}function Es(e){var n,t,r,i,s,o,a,l=0,c=null,u,f,p;if(n=Et.exec(e),n===null&&(n=xt.exec(e)),n===null)throw new Error("Date resolve error");if(t=+n[1],r=+n[2]-1,i=+n[3],!n[4])return new Date(Date.UTC(t,r,i));if(s=+n[4],o=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(u=+n[10],f=+(n[11]||0),c=(u*60+f)*6e4,n[9]==="-"&&(c=-c)),p=new Date(Date.UTC(t,r,i,s,o,a,l)),c&&p.setTime(p.getTime()-c),p}function xs(e){return e.toISOString()}var Lt=new W("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Is,construct:Es,instanceOf:Date,represent:xs});function Ls(e){return e==="<<"||e===null}var Ft=new W("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Ls}),Cn=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Fs(e){if(e===null)return!1;var n,t,r=0,i=e.length,s=Cn;for(t=0;t<i;t++)if(n=s.indexOf(e.charAt(t)),!(n>64)){if(n<0)return!1;r+=6}return r%8===0}function Rs(e){var n,t,r=e.replace(/[\r\n=]/g,""),i=r.length,s=Cn,o=0,a=[];for(n=0;n<i;n++)n%4===0&&n&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|s.indexOf(r.charAt(n));return t=i%4*6,t===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):t===18?(a.push(o>>10&255),a.push(o>>2&255)):t===12&&a.push(o>>4&255),new Uint8Array(a)}function Ns(e){var n="",t=0,r,i,s=e.length,o=Cn;for(r=0;r<s;r++)r%3===0&&r&&(n+=o[t>>18&63],n+=o[t>>12&63],n+=o[t>>6&63],n+=o[t&63]),t=(t<<8)+e[r];return i=s%3,i===0?(n+=o[t>>18&63],n+=o[t>>12&63],n+=o[t>>6&63],n+=o[t&63]):i===2?(n+=o[t>>10&63],n+=o[t>>4&63],n+=o[t<<2&63],n+=o[64]):i===1&&(n+=o[t>>2&63],n+=o[t<<4&63],n+=o[64],n+=o[64]),n}function Ts(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var Rt=new W("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Fs,construct:Rs,predicate:Ts,represent:Ns}),Ms=Object.prototype.hasOwnProperty,Ps=Object.prototype.toString;function Os(e){if(e===null)return!0;var n=[],t,r,i,s,o,a=e;for(t=0,r=a.length;t<r;t+=1){if(i=a[t],o=!1,Ps.call(i)!=="[object Object]")return!1;for(s in i)if(Ms.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(n.indexOf(s)===-1)n.push(s);else return!1}return!0}function Ds(e){return e!==null?e:[]}var Nt=new W("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Os,construct:Ds}),Ws=Object.prototype.toString;function Hs(e){if(e===null)return!0;var n,t,r,i,s,o=e;for(s=new Array(o.length),n=0,t=o.length;n<t;n+=1){if(r=o[n],Ws.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[n]=[i[0],r[i[0]]]}return!0}function $s(e){if(e===null)return[];var n,t,r,i,s,o=e;for(s=new Array(o.length),n=0,t=o.length;n<t;n+=1)r=o[n],i=Object.keys(r),s[n]=[i[0],r[i[0]]];return s}var Tt=new W("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Hs,construct:$s}),Bs=Object.prototype.hasOwnProperty;function Vs(e){if(e===null)return!0;var n,t=e;for(n in t)if(Bs.call(t,n)&&t[n]!==null)return!1;return!0}function Us(e){return e!==null?e:{}}var Mt=new W("tag:yaml.org,2002:set",{kind:"mapping",resolve:Vs,construct:Us}),wn=It.extend({implicit:[Lt,Ft],explicit:[Rt,Nt,Tt,Mt]}),pe=Object.prototype.hasOwnProperty,Ge=1,Pt=2,Ot=3,je=4,kn=1,Gs=2,Dt=3,js=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,zs=/[\x85\u2028\u2029]/,Ys=/[,\[\]\{\}]/,Wt=/^(?:!|!!|![a-z\-]+!)$/i,Ht=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function $t(e){return Object.prototype.toString.call(e)}function re(e){return e===10||e===13}function Se(e){return e===9||e===32}function G(e){return e===9||e===32||e===10||e===13}function ke(e){return e===44||e===91||e===93||e===123||e===125}function Ks(e){var n;return 48<=e&&e<=57?e-48:(n=e|32,97<=n&&n<=102?n-97+10:-1)}function qs(e){return e===120?2:e===117?4:e===85?8:0}function Xs(e){return 48<=e&&e<=57?e-48:-1}function Bt(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function Zs(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function Vt(e,n,t){n==="__proto__"?Object.defineProperty(e,n,{configurable:!0,enumerable:!0,writable:!0,value:t}):e[n]=t}for(var Ut=new Array(256),Gt=new Array(256),ye=0;ye<256;ye++)Ut[ye]=Bt(ye)?1:0,Gt[ye]=Bt(ye);function Qs(e,n){this.input=e,this.filename=n.filename||null,this.schema=n.schema||wn,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function jt(e,n){var t={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return t.snippet=ts(t),new V(n,t)}function C(e,n){throw jt(e,n)}function ze(e,n){e.onWarning&&e.onWarning.call(null,jt(e,n))}var zt={YAML:function(n,t,r){var i,s,o;n.version!==null&&C(n,"duplication of %YAML directive"),r.length!==1&&C(n,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&C(n,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&C(n,"unacceptable YAML version of the document"),n.version=r[0],n.checkLineBreaks=o<2,o!==1&&o!==2&&ze(n,"unsupported YAML version of the document")},TAG:function(n,t,r){var i,s;r.length!==2&&C(n,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],Wt.test(i)||C(n,"ill-formed tag handle (first argument) of the TAG directive"),pe.call(n.tagMap,i)&&C(n,'there is a previously declared suffix for "'+i+'" tag handle'),Ht.test(s)||C(n,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{C(n,"tag prefix is malformed: "+s)}n.tagMap[i]=s}};function de(e,n,t,r){var i,s,o,a;if(n<t){if(a=e.input.slice(n,t),r)for(i=0,s=a.length;i<s;i+=1)o=a.charCodeAt(i),o===9||32<=o&&o<=1114111||C(e,"expected valid JSON character");else js.test(a)&&C(e,"the stream contains non-printable characters");e.result+=a}}function Yt(e,n,t,r){var i,s,o,a;for(P.isObject(t)||C(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(t),o=0,a=i.length;o<a;o+=1)s=i[o],pe.call(n,s)||(Vt(n,s,t[s]),r[s]=!0)}function Ae(e,n,t,r,i,s,o,a,l){var c,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),c=0,u=i.length;c<u;c+=1)Array.isArray(i[c])&&C(e,"nested arrays are not supported inside keys"),typeof i=="object"&&$t(i[c])==="[object Object]"&&(i[c]="[object Object]");if(typeof i=="object"&&$t(i)==="[object Object]"&&(i="[object Object]"),i=String(i),n===null&&(n={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(c=0,u=s.length;c<u;c+=1)Yt(e,n,s[c],t);else Yt(e,n,s,t);else!e.json&&!pe.call(t,i)&&pe.call(n,i)&&(e.line=o||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,C(e,"duplicated mapping key")),Vt(n,i,s),delete t[i];return n}function yn(e){var n;n=e.input.charCodeAt(e.position),n===10?e.position++:n===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):C(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function T(e,n,t){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;Se(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(n&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(re(i))for(yn(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return t!==-1&&r!==0&&e.lineIndent<t&&ze(e,"deficient indentation"),r}function Ye(e){var n=e.position,t;return t=e.input.charCodeAt(n),!!((t===45||t===46)&&t===e.input.charCodeAt(n+1)&&t===e.input.charCodeAt(n+2)&&(n+=3,t=e.input.charCodeAt(n),t===0||G(t)))}function An(e,n){n===1?e.result+=" ":n>1&&(e.result+=P.repeat(`
`,n-1))}function Js(e,n,t){var r,i,s,o,a,l,c,u,f=e.kind,p=e.result,d;if(d=e.input.charCodeAt(e.position),G(d)||ke(d)||d===35||d===38||d===42||d===33||d===124||d===62||d===39||d===34||d===37||d===64||d===96||(d===63||d===45)&&(i=e.input.charCodeAt(e.position+1),G(i)||t&&ke(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,a=!1;d!==0;){if(d===58){if(i=e.input.charCodeAt(e.position+1),G(i)||t&&ke(i))break}else if(d===35){if(r=e.input.charCodeAt(e.position-1),G(r))break}else{if(e.position===e.lineStart&&Ye(e)||t&&ke(d))break;if(re(d))if(l=e.line,c=e.lineStart,u=e.lineIndent,T(e,!1,-1),e.lineIndent>=n){a=!0,d=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=l,e.lineStart=c,e.lineIndent=u;break}}a&&(de(e,s,o,!1),An(e,e.line-l),s=o=e.position,a=!1),Se(d)||(o=e.position+1),d=e.input.charCodeAt(++e.position)}return de(e,s,o,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function eo(e,n){var t,r,i;if(t=e.input.charCodeAt(e.position),t!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(t=e.input.charCodeAt(e.position))!==0;)if(t===39)if(de(e,r,e.position,!0),t=e.input.charCodeAt(++e.position),t===39)r=e.position,e.position++,i=e.position;else return!0;else re(t)?(de(e,r,i,!0),An(e,T(e,!1,n)),r=i=e.position):e.position===e.lineStart&&Ye(e)?C(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);C(e,"unexpected end of the stream within a single quoted scalar")}function no(e,n){var t,r,i,s,o,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,t=r=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return de(e,t,e.position,!0),e.position++,!0;if(a===92){if(de(e,t,e.position,!0),a=e.input.charCodeAt(++e.position),re(a))T(e,!1,n);else if(a<256&&Ut[a])e.result+=Gt[a],e.position++;else if((o=qs(a))>0){for(i=o,s=0;i>0;i--)a=e.input.charCodeAt(++e.position),(o=Ks(a))>=0?s=(s<<4)+o:C(e,"expected hexadecimal character");e.result+=Zs(s),e.position++}else C(e,"unknown escape sequence");t=r=e.position}else re(a)?(de(e,t,r,!0),An(e,T(e,!1,n)),t=r=e.position):e.position===e.lineStart&&Ye(e)?C(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}C(e,"unexpected end of the stream within a double quoted scalar")}function to(e,n){var t=!0,r,i,s,o=e.tag,a,l=e.anchor,c,u,f,p,d,m=Object.create(null),h,S,w,g;if(g=e.input.charCodeAt(e.position),g===91)u=93,d=!1,a=[];else if(g===123)u=125,d=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),g=e.input.charCodeAt(++e.position);g!==0;){if(T(e,!0,n),g=e.input.charCodeAt(e.position),g===u)return e.position++,e.tag=o,e.anchor=l,e.kind=d?"mapping":"sequence",e.result=a,!0;t?g===44&&C(e,"expected the node content, but found ','"):C(e,"missed comma between flow collection entries"),S=h=w=null,f=p=!1,g===63&&(c=e.input.charCodeAt(e.position+1),G(c)&&(f=p=!0,e.position++,T(e,!0,n))),r=e.line,i=e.lineStart,s=e.position,_e(e,n,Ge,!1,!0),S=e.tag,h=e.result,T(e,!0,n),g=e.input.charCodeAt(e.position),(p||e.line===r)&&g===58&&(f=!0,g=e.input.charCodeAt(++e.position),T(e,!0,n),_e(e,n,Ge,!1,!0),w=e.result),d?Ae(e,a,m,S,h,w,r,i,s):f?a.push(Ae(e,null,m,S,h,w,r,i,s)):a.push(h),T(e,!0,n),g=e.input.charCodeAt(e.position),g===44?(t=!0,g=e.input.charCodeAt(++e.position)):t=!1}C(e,"unexpected end of the stream within a flow collection")}function io(e,n){var t,r,i=kn,s=!1,o=!1,a=n,l=0,c=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)r=!1;else if(f===62)r=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)kn===i?i=f===43?Dt:Gs:C(e,"repeat of a chomping mode identifier");else if((u=Xs(f))>=0)u===0?C(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?C(e,"repeat of an indentation width identifier"):(a=n+u-1,o=!0);else break;if(Se(f)){do f=e.input.charCodeAt(++e.position);while(Se(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!re(f)&&f!==0)}for(;f!==0;){for(yn(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!o||e.lineIndent<a)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>a&&(a=e.lineIndent),re(f)){l++;continue}if(e.lineIndent<a){i===Dt?e.result+=P.repeat(`
`,s?1+l:l):i===kn&&s&&(e.result+=`
`);break}for(r?Se(f)?(c=!0,e.result+=P.repeat(`
`,s?1+l:l)):c?(c=!1,e.result+=P.repeat(`
`,l+1)):l===0?s&&(e.result+=" "):e.result+=P.repeat(`
`,l):e.result+=P.repeat(`
`,s?1+l:l),s=!0,o=!0,l=0,t=e.position;!re(f)&&f!==0;)f=e.input.charCodeAt(++e.position);de(e,t,e.position,!1)}return!0}function Kt(e,n){var t,r=e.tag,i=e.anchor,s=[],o,a=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,C(e,"tab characters must not be used in indentation")),!(l!==45||(o=e.input.charCodeAt(e.position+1),!G(o))));){if(a=!0,e.position++,T(e,!0,-1)&&e.lineIndent<=n){s.push(null),l=e.input.charCodeAt(e.position);continue}if(t=e.line,_e(e,n,Ot,!1,!0),s.push(e.result),T(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===t||e.lineIndent>n)&&l!==0)C(e,"bad indentation of a sequence entry");else if(e.lineIndent<n)break}return a?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function ro(e,n,t){var r,i,s,o,a,l,c=e.tag,u=e.anchor,f={},p=Object.create(null),d=null,m=null,h=null,S=!1,w=!1,g;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),g=e.input.charCodeAt(e.position);g!==0;){if(!S&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,C(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(g===63||g===58)&&G(r))g===63?(S&&(Ae(e,f,p,d,m,null,o,a,l),d=m=h=null),w=!0,S=!0,i=!0):S?(S=!1,i=!0):C(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,g=r;else{if(o=e.line,a=e.lineStart,l=e.position,!_e(e,t,Pt,!1,!0))break;if(e.line===s){for(g=e.input.charCodeAt(e.position);Se(g);)g=e.input.charCodeAt(++e.position);if(g===58)g=e.input.charCodeAt(++e.position),G(g)||C(e,"a whitespace character is expected after the key-value separator within a block mapping"),S&&(Ae(e,f,p,d,m,null,o,a,l),d=m=h=null),w=!0,S=!1,i=!1,d=e.tag,m=e.result;else if(w)C(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(w)C(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===s||e.lineIndent>n)&&(S&&(o=e.line,a=e.lineStart,l=e.position),_e(e,n,je,!0,i)&&(S?m=e.result:h=e.result),S||(Ae(e,f,p,d,m,h,o,a,l),d=m=h=null),T(e,!0,-1),g=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>n)&&g!==0)C(e,"bad indentation of a mapping entry");else if(e.lineIndent<n)break}return S&&Ae(e,f,p,d,m,null,o,a,l),w&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=f),w}function so(e){var n,t=!1,r=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&C(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(t=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",n=e.position,t){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(n,e.position),o=e.input.charCodeAt(++e.position)):C(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!G(o);)o===33&&(r?C(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(n-1,e.position+1),Wt.test(i)||C(e,"named tag handle cannot contain such characters"),r=!0,n=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(n,e.position),Ys.test(s)&&C(e,"tag suffix cannot contain flow indicator characters")}s&&!Ht.test(s)&&C(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{C(e,"tag name is malformed: "+s)}return t?e.tag=s:pe.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:C(e,'undeclared tag handle "'+i+'"'),!0}function oo(e){var n,t;if(t=e.input.charCodeAt(e.position),t!==38)return!1;for(e.anchor!==null&&C(e,"duplication of an anchor property"),t=e.input.charCodeAt(++e.position),n=e.position;t!==0&&!G(t)&&!ke(t);)t=e.input.charCodeAt(++e.position);return e.position===n&&C(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(n,e.position),!0}function ao(e){var n,t,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),n=e.position;r!==0&&!G(r)&&!ke(r);)r=e.input.charCodeAt(++e.position);return e.position===n&&C(e,"name of an alias node must contain at least one character"),t=e.input.slice(n,e.position),pe.call(e.anchorMap,t)||C(e,'unidentified alias "'+t+'"'),e.result=e.anchorMap[t],T(e,!0,-1),!0}function _e(e,n,t,r,i){var s,o,a,l=1,c=!1,u=!1,f,p,d,m,h,S;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=a=je===t||Ot===t,r&&T(e,!0,-1)&&(c=!0,e.lineIndent>n?l=1:e.lineIndent===n?l=0:e.lineIndent<n&&(l=-1)),l===1)for(;so(e)||oo(e);)T(e,!0,-1)?(c=!0,a=s,e.lineIndent>n?l=1:e.lineIndent===n?l=0:e.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=c||i),(l===1||je===t)&&(Ge===t||Pt===t?h=n:h=n+1,S=e.position-e.lineStart,l===1?a&&(Kt(e,S)||ro(e,S,h))||to(e,h)?u=!0:(o&&io(e,h)||eo(e,h)||no(e,h)?u=!0:ao(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&C(e,"alias node should not have any properties")):Js(e,h,Ge===t)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=a&&Kt(e,S))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&C(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(m=e.implicitTypes[f],m.resolve(e.result)){e.result=m.construct(e.result),e.tag=m.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(pe.call(e.typeMap[e.kind||"fallback"],e.tag))m=e.typeMap[e.kind||"fallback"][e.tag];else for(m=null,d=e.typeMap.multi[e.kind||"fallback"],f=0,p=d.length;f<p;f+=1)if(e.tag.slice(0,d[f].tag.length)===d[f].tag){m=d[f];break}m||C(e,"unknown tag !<"+e.tag+">"),e.result!==null&&m.kind!==e.kind&&C(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+m.kind+'", not "'+e.kind+'"'),m.resolve(e.result,e.tag)?(e.result=m.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):C(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function lo(e){var n=e.position,t,r,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(T(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),t=e.position;o!==0&&!G(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(t,e.position),i=[],r.length<1&&C(e,"directive name must not be less than one character in length");o!==0;){for(;Se(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!re(o));break}if(re(o))break;for(t=e.position;o!==0&&!G(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}o!==0&&yn(e),pe.call(zt,r)?zt[r](e,r,i):ze(e,'unknown document directive "'+r+'"')}if(T(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,T(e,!0,-1)):s&&C(e,"directives end mark is expected"),_e(e,e.lineIndent-1,je,!1,!0),T(e,!0,-1),e.checkLineBreaks&&zs.test(e.input.slice(n,e.position))&&ze(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Ye(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,T(e,!0,-1));return}if(e.position<e.length-1)C(e,"end of the stream or a document separator is expected");else return}function qt(e,n){e=String(e),n=n||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var t=new Qs(e,n),r=e.indexOf("\0");for(r!==-1&&(t.position=r,C(t,"null byte is not allowed in input")),t.input+="\0";t.input.charCodeAt(t.position)===32;)t.lineIndent+=1,t.position+=1;for(;t.position<t.length-1;)lo(t);return t.documents}function co(e,n,t){n!==null&&typeof n=="object"&&typeof t>"u"&&(t=n,n=null);var r=qt(e,t);if(typeof n!="function")return r;for(var i=0,s=r.length;i<s;i+=1)n(r[i])}function uo(e,n){var t=qt(e,n);if(t.length!==0){if(t.length===1)return t[0];throw new V("expected a single document in the stream, but found more")}}var fo=co,po=uo,Xt={loadAll:fo,load:po},Zt=Object.prototype.toString,Qt=Object.prototype.hasOwnProperty,_n=65279,mo=9,Re=10,ho=13,go=32,vo=33,So=34,bn=35,Co=37,wo=38,ko=39,yo=42,Jt=44,Ao=45,Ke=58,_o=61,bo=62,Io=63,Eo=64,ei=91,ni=93,xo=96,ti=123,Lo=124,ii=125,$={};$[0]="\\0",$[7]="\\a",$[8]="\\b",$[9]="\\t",$[10]="\\n",$[11]="\\v",$[12]="\\f",$[13]="\\r",$[27]="\\e",$[34]='\\"',$[92]="\\\\",$[133]="\\N",$[160]="\\_",$[8232]="\\L",$[8233]="\\P";var Fo=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Ro=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function No(e,n){var t,r,i,s,o,a,l;if(n===null)return{};for(t={},r=Object.keys(n),i=0,s=r.length;i<s;i+=1)o=r[i],a=String(n[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=e.compiledTypeMap.fallback[o],l&&Qt.call(l.styleAliases,a)&&(a=l.styleAliases[a]),t[o]=a;return t}function To(e){var n,t,r;if(n=e.toString(16).toUpperCase(),e<=255)t="x",r=2;else if(e<=65535)t="u",r=4;else if(e<=4294967295)t="U",r=8;else throw new V("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+t+P.repeat("0",r-n.length)+n}var Mo=1,Ne=2;function Po(e){this.schema=e.schema||wn,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=P.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=No(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Ne:Mo,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function ri(e,n){for(var t=P.repeat(" ",n),r=0,i=-1,s="",o,a=e.length;r<a;)i=e.indexOf(`
`,r),i===-1?(o=e.slice(r),r=a):(o=e.slice(r,i+1),r=i+1),o.length&&o!==`
`&&(s+=t),s+=o;return s}function In(e,n){return`
`+P.repeat(" ",e.indent*n)}function Oo(e,n){var t,r,i;for(t=0,r=e.implicitTypes.length;t<r;t+=1)if(i=e.implicitTypes[t],i.resolve(n))return!0;return!1}function qe(e){return e===go||e===mo}function Te(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==_n||65536<=e&&e<=1114111}function si(e){return Te(e)&&e!==_n&&e!==ho&&e!==Re}function oi(e,n,t){var r=si(e),i=r&&!qe(e);return(t?r:r&&e!==Jt&&e!==ei&&e!==ni&&e!==ti&&e!==ii)&&e!==bn&&!(n===Ke&&!i)||si(n)&&!qe(n)&&e===bn||n===Ke&&i}function Do(e){return Te(e)&&e!==_n&&!qe(e)&&e!==Ao&&e!==Io&&e!==Ke&&e!==Jt&&e!==ei&&e!==ni&&e!==ti&&e!==ii&&e!==bn&&e!==wo&&e!==yo&&e!==vo&&e!==Lo&&e!==_o&&e!==bo&&e!==ko&&e!==So&&e!==Co&&e!==Eo&&e!==xo}function Wo(e){return!qe(e)&&e!==Ke}function Me(e,n){var t=e.charCodeAt(n),r;return t>=55296&&t<=56319&&n+1<e.length&&(r=e.charCodeAt(n+1),r>=56320&&r<=57343)?(t-55296)*1024+r-56320+65536:t}function ai(e){var n=/^\n* /;return n.test(e)}var li=1,En=2,ci=3,ui=4,be=5;function Ho(e,n,t,r,i,s,o,a){var l,c=0,u=null,f=!1,p=!1,d=r!==-1,m=-1,h=Do(Me(e,0))&&Wo(Me(e,e.length-1));if(n||o)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Me(e,l),!Te(c))return be;h=h&&oi(c,u,a),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Me(e,l),c===Re)f=!0,d&&(p=p||l-m-1>r&&e[m+1]!==" ",m=l);else if(!Te(c))return be;h=h&&oi(c,u,a),u=c}p=p||d&&l-m-1>r&&e[m+1]!==" "}return!f&&!p?h&&!o&&!i(e)?li:s===Ne?be:En:t>9&&ai(e)?be:o?s===Ne?be:En:p?ui:ci}function $o(e,n,t,r,i){e.dump=function(){if(n.length===0)return e.quotingType===Ne?'""':"''";if(!e.noCompatMode&&(Fo.indexOf(n)!==-1||Ro.test(n)))return e.quotingType===Ne?'"'+n+'"':"'"+n+"'";var s=e.indent*Math.max(1,t),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),a=r||e.flowLevel>-1&&t>=e.flowLevel;function l(c){return Oo(e,c)}switch(Ho(n,a,e.indent,o,l,e.quotingType,e.forceQuotes&&!r,i)){case li:return n;case En:return"'"+n.replace(/'/g,"''")+"'";case ci:return"|"+fi(n,e.indent)+pi(ri(n,s));case ui:return">"+fi(n,e.indent)+pi(ri(Bo(n,o),s));case be:return'"'+Vo(n)+'"';default:throw new V("impossible error: invalid scalar style")}}()}function fi(e,n){var t=ai(e)?String(n):"",r=e[e.length-1]===`
`,i=r&&(e[e.length-2]===`
`||e===`
`),s=i?"+":r?"":"-";return t+s+`
`}function pi(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function Bo(e,n){for(var t=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,t.lastIndex=c,di(e.slice(0,c),n)}(),i=e[0]===`
`||e[0]===" ",s,o;o=t.exec(e);){var a=o[1],l=o[2];s=l[0]===" ",r+=a+(!i&&!s&&l!==""?`
`:"")+di(l,n),i=s}return r}function di(e,n){if(e===""||e[0]===" ")return e;for(var t=/ [^ ]/g,r,i=0,s,o=0,a=0,l="";r=t.exec(e);)a=r.index,a-i>n&&(s=o>i?o:a,l+=`
`+e.slice(i,s),i=s+1),o=a;return l+=`
`,e.length-i>n&&o>i?l+=e.slice(i,o)+`
`+e.slice(o+1):l+=e.slice(i),l.slice(1)}function Vo(e){for(var n="",t=0,r,i=0;i<e.length;t>=65536?i+=2:i++)t=Me(e,i),r=$[t],!r&&Te(t)?(n+=e[i],t>=65536&&(n+=e[i+1])):n+=r||To(t);return n}function Uo(e,n,t){var r="",i=e.tag,s,o,a;for(s=0,o=t.length;s<o;s+=1)a=t[s],e.replacer&&(a=e.replacer.call(t,String(s),a)),(le(e,n,a,!1,!1)||typeof a>"u"&&le(e,n,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=i,e.dump="["+r+"]"}function mi(e,n,t,r){var i="",s=e.tag,o,a,l;for(o=0,a=t.length;o<a;o+=1)l=t[o],e.replacer&&(l=e.replacer.call(t,String(o),l)),(le(e,n+1,l,!0,!0,!1,!0)||typeof l>"u"&&le(e,n+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=In(e,n)),e.dump&&Re===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function Go(e,n,t){var r="",i=e.tag,s=Object.keys(t),o,a,l,c,u;for(o=0,a=s.length;o<a;o+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=s[o],c=t[l],e.replacer&&(c=e.replacer.call(t,l,c)),le(e,n,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),le(e,n,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=i,e.dump="{"+r+"}"}function jo(e,n,t,r){var i="",s=e.tag,o=Object.keys(t),a,l,c,u,f,p;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new V("sortKeys must be a boolean or a function");for(a=0,l=o.length;a<l;a+=1)p="",(!r||i!=="")&&(p+=In(e,n)),c=o[a],u=t[c],e.replacer&&(u=e.replacer.call(t,c,u)),le(e,n+1,c,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&Re===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=In(e,n)),le(e,n+1,u,!0,f)&&(e.dump&&Re===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,i+=p));e.tag=s,e.dump=i||"{}"}function hi(e,n,t){var r,i,s,o,a,l;for(i=t?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(a=i[s],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof n=="object"&&n instanceof a.instanceOf)&&(!a.predicate||a.predicate(n))){if(t?a.multi&&a.representName?e.tag=a.representName(n):e.tag=a.tag:e.tag="?",a.represent){if(l=e.styleMap[a.tag]||a.defaultStyle,Zt.call(a.represent)==="[object Function]")r=a.represent(n,l);else if(Qt.call(a.represent,l))r=a.represent[l](n,l);else throw new V("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}function le(e,n,t,r,i,s,o){e.tag=null,e.dump=t,hi(e,t,!1)||hi(e,t,!0);var a=Zt.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>n);var u=a==="[object Object]"||a==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(t),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&n>0)&&(i=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),a==="[object Object]")r&&Object.keys(e.dump).length!==0?(jo(e,n,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(Go(e,n,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(a==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&n>0?mi(e,n-1,e.dump,i):mi(e,n,e.dump,i),p&&(e.dump="&ref_"+f+e.dump)):(Uo(e,n,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(a==="[object String]")e.tag!=="?"&&$o(e,e.dump,n,s,l);else{if(a==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new V("unacceptable kind of an object to dump "+a)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}function zo(e,n){var t=[],r=[],i,s;for(xn(e,t,r),i=0,s=r.length;i<s;i+=1)n.duplicates.push(t[r[i]]);n.usedDuplicates=new Array(s)}function xn(e,n,t){var r,i,s;if(e!==null&&typeof e=="object")if(i=n.indexOf(e),i!==-1)t.indexOf(i)===-1&&t.push(i);else if(n.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)xn(e[i],n,t);else for(r=Object.keys(e),i=0,s=r.length;i<s;i+=1)xn(e[r[i]],n,t)}function Yo(e,n){n=n||{};var t=new Po(n);t.noRefs||zo(e,t);var r=e;return t.replacer&&(r=t.replacer.call({"":r},"",r)),le(t,0,r,!0,!0)?t.dump+`
`:""}var Ko=Yo,qo={dump:Ko};function Ln(e,n){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var Xo=W,Zo=gt,Qo=wt,Jo=bt,ea=It,na=wn,ta=Xt.load,ia=Xt.loadAll,ra=qo.dump,sa=V,oa={binary:Rt,float:_t,map:Ct,null:kt,pairs:Tt,set:Mt,timestamp:Lt,bool:yt,int:At,merge:Ft,omap:Nt,seq:St,str:vt},aa=Ln("safeLoad","load"),la=Ln("safeLoadAll","loadAll"),ca=Ln("safeDump","dump"),ua={Type:Xo,Schema:Zo,FAILSAFE_SCHEMA:Qo,JSON_SCHEMA:Jo,CORE_SCHEMA:ea,DEFAULT_SCHEMA:na,load:ta,loadAll:ia,dump:ra,YAMLException:sa,types:oa,safeLoad:aa,safeLoadAll:la,safeDump:ca};function fa(e){try{return pa(e)}catch(n){return console.error("parsePlanYaml failed:",n),{plans:[],events:[],stats:{totalLines:e.split(`
`).length,parsedLines:0,errorLines:0,duplicateLines:0,plansFound:0,vmsFound:0},summary:{totalPlans:0,running:0,succeeded:0,failed:0,archived:0,pending:0},networkMaps:[],storageMaps:[]}}}function pa(e){const n=ua.loadAll(e),t=[],r=[],i=[];for(const u of n){if(!u||typeof u!="object")continue;const f=u;if(f.kind==="PlanList"||f.kind==="List"){const p=u;if(p.items&&Array.isArray(p.items))for(const d of p.items)gi(d)&&t.push(d);continue}if(f.kind==="NetworkMapList"){const p=u;if(p.items&&Array.isArray(p.items))for(const d of p.items)vi(d)&&r.push(d);continue}if(f.kind==="StorageMapList"){const p=u;if(p.items&&Array.isArray(p.items))for(const d of p.items)Si(d)&&i.push(d);continue}gi(u)?t.push(u):vi(u)?r.push(u):Si(u)&&i.push(u)}const s=t.map(ha),o=r.map(da),a=i.map(ma),l={totalLines:e.split(`
`).length,parsedLines:e.split(`
`).length,errorLines:0,duplicateLines:0,plansFound:s.length,vmsFound:s.reduce((u,f)=>u+Object.keys(f.vms).length,0)},c={totalPlans:s.length,running:s.filter(u=>u.status===y.Running).length,succeeded:s.filter(u=>u.status===y.Succeeded).length,failed:s.filter(u=>u.status===y.Failed).length,archived:s.filter(u=>u.archived).length,pending:s.filter(u=>u.status===y.Pending||u.status===y.Ready).length};return{plans:s,events:[],summary:c,stats:l,networkMaps:o,storageMaps:a}}function gi(e){if(!e||typeof e!="object")return!1;const n=e;return n.kind==="Plan"&&typeof n.apiVersion=="string"&&n.apiVersion.startsWith("forklift.konveyor.io/")}function vi(e){if(!e||typeof e!="object")return!1;const n=e;return n.kind==="NetworkMap"&&typeof n.apiVersion=="string"&&n.apiVersion.startsWith("forklift.konveyor.io/")}function Si(e){if(!e||typeof e!="object")return!1;const n=e;return n.kind==="StorageMap"&&typeof n.apiVersion=="string"&&n.apiVersion.startsWith("forklift.konveyor.io/")}function da(e){var l,c,u,f,p,d,m,h,S,w;const n=((l=e.metadata)==null?void 0:l.name)||"unknown",t=((c=e.metadata)==null?void 0:c.namespace)||"default",r=(p=(f=(u=e.metadata)==null?void 0:u.ownerReferences)==null?void 0:f.find(g=>g.kind==="Plan"))==null?void 0:p.name,i=(((d=e.spec)==null?void 0:d.map)||[]).map(g=>{var _,I,x,j,Y;return{source:{id:(_=g.source)==null?void 0:_.id,name:(I=g.source)==null?void 0:I.name},destination:{type:(x=g.destination)==null?void 0:x.type,name:(j=g.destination)==null?void 0:j.name,namespace:(Y=g.destination)==null?void 0:Y.namespace}}}),s=(m=e.spec)!=null&&m.provider?{source:e.spec.provider.source?{name:e.spec.provider.source.name,namespace:e.spec.provider.source.namespace}:void 0,destination:e.spec.provider.destination?{name:e.spec.provider.destination.name,namespace:e.spec.provider.destination.namespace}:void 0}:void 0,o=(((h=e.status)==null?void 0:h.conditions)||[]).map(g=>({type:g.type||"",status:g.status||"",category:g.category,message:g.message||"",timestamp:new Date(g.lastTransitionTime||0)})),a=(w=(S=e.status)==null?void 0:S.references)==null?void 0:w.map(g=>({id:g.id||"",name:g.name||""}));return{name:n,namespace:t,ownerPlanName:r,entries:i,provider:s,conditions:o,references:a}}function ma(e){var a,l,c,u,f,p,d,m;const n=((a=e.metadata)==null?void 0:a.name)||"unknown",t=((l=e.metadata)==null?void 0:l.namespace)||"default",r=(f=(u=(c=e.metadata)==null?void 0:c.ownerReferences)==null?void 0:u.find(h=>h.kind==="Plan"))==null?void 0:f.name,i=(((p=e.spec)==null?void 0:p.map)||[]).map(h=>{var S,w,g,_,I,x;return{source:{id:(S=h.source)==null?void 0:S.id,name:(w=h.source)==null?void 0:w.name},destination:{storageClass:(g=h.destination)==null?void 0:g.storageClass,accessMode:(_=h.destination)==null?void 0:_.accessMode,volumeMode:(I=h.destination)==null?void 0:I.volumeMode,name:(x=h.destination)==null?void 0:x.name}}}),s=(d=e.spec)!=null&&d.provider?{source:e.spec.provider.source?{name:e.spec.provider.source.name,namespace:e.spec.provider.source.namespace}:void 0,destination:e.spec.provider.destination?{name:e.spec.provider.destination.name,namespace:e.spec.provider.destination.namespace}:void 0}:void 0,o=(((m=e.status)==null?void 0:m.conditions)||[]).map(h=>({type:h.type||"",status:h.status||"",category:h.category,message:h.message||"",timestamp:new Date(h.lastTransitionTime||0)}));return{name:n,namespace:t,ownerPlanName:r,entries:i,provider:s,conditions:o}}function ha(e){var d,m,h,S,w,g,_,I,x,j,Y,K,D,Z,E,k,q,R,Q,H,J,U,M,me;const n=((d=e.metadata)==null?void 0:d.name)||"unknown",t=((m=e.metadata)==null?void 0:m.namespace)||"default",r=((h=e.spec)==null?void 0:h.type)||((S=e.spec)!=null&&S.warm?"warm":"cold");let i=O.Unknown;r==="warm"?i=O.Warm:r==="cold"&&(i=O.Cold);const s=(((w=e.status)==null?void 0:w.conditions)||[]).map(A=>({type:A.type||"",status:A.status||"",category:A.category,message:A.message||"",timestamp:new Date(A.lastTransitionTime||0)})),o=!!((g=e.spec)!=null&&g.archived);let a=y.Pending;for(const A of s){if(A.type==="Succeeded"&&A.status===fe.True){a=y.Succeeded;break}if(A.type==="Failed"&&A.status===fe.True){a=y.Failed;break}A.type==="Executing"&&A.status===fe.True&&(a=y.Running),A.type==="Ready"&&A.status===fe.True&&a===y.Pending&&(a=y.Ready)}const l={},c=((I=(_=e.status)==null?void 0:_.migration)==null?void 0:I.vms)||[];if(a===y.Pending||a===y.Ready){const A=(x=e.status)==null?void 0:x.migration;if(c.length>0){const z=c.some(se=>{var he;return!!se.error||((he=se.pipeline)==null?void 0:he.some(Pe=>!!Pe.error))}),L=c.every(se=>!!se.completed||se.phase===v.Completed);z?a=y.Failed:A!=null&&A.completed||L?a=y.Succeeded:A!=null&&A.started&&(a=y.Running)}}for(const A of c){const z=ga(A,i);z&&(l[z.id]=z)}const u=(Y=(j=e.status)==null?void 0:j.migration)==null?void 0:Y.started,f=(D=(K=e.status)==null?void 0:K.migration)==null?void 0:D.completed,p=e.spec?{description:e.spec.description,targetNamespace:e.spec.targetNamespace,preserveStaticIPs:e.spec.preserveStaticIPs,skipGuestConversion:e.spec.skipGuestConversion,useCompatibilityMode:e.spec.useCompatibilityMode,runPreflightInspection:e.spec.runPreflightInspection,targetPowerState:e.spec.targetPowerState,migrateSharedDisks:e.spec.migrateSharedDisks,pvcNameTemplateUseGenerateName:e.spec.pvcNameTemplateUseGenerateName,preserveClusterCPUModel:e.spec.preserveClusterCpuModel,deleteGuestConversionPod:e.spec.deleteGuestConversionPod,deleteVmOnFailMigration:e.spec.deleteVmOnFailMigration,installLegacyDrivers:e.spec.installLegacyDrivers,transferNetwork:(Z=e.spec.transferNetwork)==null?void 0:Z.name,sourceProvider:(k=(E=e.spec.provider)==null?void 0:E.source)==null?void 0:k.name,destinationProvider:(R=(q=e.spec.provider)==null?void 0:q.destination)==null?void 0:R.name,networkMap:(H=(Q=e.spec.map)==null?void 0:Q.network)==null?void 0:H.name,storageMap:(U=(J=e.spec.map)==null?void 0:J.storage)==null?void 0:U.name}:void 0;return{name:n,namespace:t,status:a,archived:o,migrationType:i,conditions:s,vms:l,errors:[],panics:[],firstSeen:new Date(u||((M=e.metadata)==null?void 0:M.creationTimestamp)||0),lastSeen:new Date(f||u||((me=e.metadata)==null?void 0:me.creationTimestamp)||0),spec:p}}function ga(e,n){var _,I,x,j,Y,K,D,Z,E;const t=e.id||"",r=e.name||"";if(!t&&!r)return null;const i=t||r,s=n===O.Warm,o=s&&((_=e.warm)!=null&&_.precopies)?e.warm.precopies:[],a=o.length,l=[],c={},u={},f={Initialize:F.Initialize,PreflightInspection:F.PreflightInspection,DiskAllocation:F.DiskAllocation,DiskTransfer:F.DiskTransfer,DiskTransferV2v:F.DiskTransferV2v,Cutover:F.Cutover,ImageConversion:F.ImageConversion,VirtualMachineCreation:F.VMCreation};for(const k of e.pipeline||[]){const q=f[k.name||""]||k.name||"",R=k.name||"Unknown",Q=R==="DiskTransfer",H=k.phase||"",J=H==="Pending"||!k.started&&!k.completed&&!k.error,U=k.started?new Date(k.started):void 0,M=k.completed?new Date(k.completed):void 0,me=U&&M?M.getTime()-U.getTime():void 0;if(J||l.push({name:R,step:q,startedAt:U||new Date(0),endedAt:M}),J)continue;const A=[],z=U||new Date(0);if(A.push({timestamp:z.toISOString(),level:"info",message:`${k.description||R} - Phase: ${H||"Unknown"}`,phase:R,rawLine:JSON.stringify({step:R,description:k.description,phase:H,progress:k.progress,started:k.started,completed:k.completed},null,2)}),k.progress){const L=((I=k.annotations)==null?void 0:I.unit)||"",se=L?`${k.progress.completed||0}/${k.progress.total||0} ${L}`:`${k.progress.completed||0}/${k.progress.total||0}`;A.push({timestamp:(M||z).toISOString(),level:"info",message:`Progress: ${se}`,phase:R,rawLine:JSON.stringify({progress:k.progress,annotations:k.annotations},null,2)})}for(const L of k.tasks||[])A.push({timestamp:(L.started?new Date(L.started):z).toISOString(),level:"info",message:`Task: ${L.name||"unknown"}${L.reason?` - ${L.reason}`:""}${(x=L.annotations)!=null&&x.Precopy?` (Precopy #${L.annotations.Precopy})`:""}`,phase:R,rawLine:JSON.stringify(L,null,2)});if(k.error)for(const L of k.error.reasons||[])A.push({timestamp:(M||z).toISOString(),level:"error",message:`${R} failed: ${L}`,phase:R,rawLine:JSON.stringify({step:R,error:k.error},null,2)});Q&&a>0&&va(A,o,e.warm,R),c[R]=A,u[R]={phase:R,startTime:U==null?void 0:U.toISOString(),endTime:M==null?void 0:M.toISOString(),duration:me?Ue(me):void 0,durationMs:me,totalLogs:A.length,groupedLogs:ct(A),summaryItems:Q&&a>0?[{label:"Precopies",value:`${a}`,type:"info"},{label:"Successes",value:`${((j=e.warm)==null?void 0:j.successes)||0}`,type:"info"},...(Y=e.warm)!=null&&Y.failures?[{label:"Failures",value:`${e.warm.failures}`,type:"error"}]:[]]:void 0}}let p;e.error&&(p={phase:e.error.phase||"",reasons:e.error.reasons||[]});const d=(e.conditions||[]).map(k=>({type:k.type||"",status:k.status||"",category:k.category,message:k.message||"",timestamp:new Date(k.lastTransitionTime||0)})),m=e.phase||(l.length>0?l[l.length-1].name:""),h=m?dn(m,s):"",S=e.started?new Date(e.started):new Date(0),w=e.completed?new Date(e.completed):void 0;let g;return s&&a>0&&(g={precopies:o.map((q,R)=>{const Q=q.start?new Date(q.start):void 0,H=q.end?new Date(q.end):void 0,J=Q&&H?H.getTime()-Q.getTime():void 0;return{iteration:R+1,snapshot:q.snapshot||"unknown",startedAt:Q,endedAt:H,durationMs:J,disks:(q.deltas||[]).map(U=>U.disk||"").filter(Boolean)}}),successes:((K=e.warm)==null?void 0:K.successes)||0,failures:((D=e.warm)==null?void 0:D.failures)||0,consecutiveFailures:((Z=e.warm)==null?void 0:Z.consecutiveFailures)||0,nextPrecopyAt:(E=e.warm)==null?void 0:E.nextPrecopyAt}),{id:i,name:r,currentPhase:m,currentStep:h,migrationType:n,transferMethod:"Unknown",phaseHistory:l,dataVolumes:[],createdResources:[],phaseLogs:c,phaseLogSummaries:u,firstSeen:S,lastSeen:w||S,fromYaml:!0,precopyCount:a>0?a:void 0,warmInfo:g,error:p,conditions:d.length>0?d:void 0,operatingSystem:e.operatingSystem,restorePowerState:e.restorePowerState,newName:e.newName&&e.newName!==r?e.newName:void 0}}function va(e,n,t,r){for(let i=0;i<n.length;i++){const s=n[i],o=i+1,a=s.start?new Date(s.start):void 0,l=s.end?new Date(s.end):void 0,c=a&&l?l.getTime()-a.getTime():void 0,u=(s.deltas||[]).map(f=>f.disk).filter(Boolean).join(", ");e.push({timestamp:(a||new Date(0)).toISOString(),level:"info",message:`Precopy ${o}/${n.length}: ${s.snapshot||"snapshot"}${c?` (${Ue(c)})`:""}${u?` - ${u}`:""}`,phase:r,rawLine:JSON.stringify({precopyIteration:o,totalPrecopies:n.length,snapshot:s.snapshot,start:s.start,end:s.end,duration:c?Ue(c):void 0,createTaskId:s.createTaskId,removeTaskId:s.removeTaskId,deltas:s.deltas},null,2)})}e.push({timestamp:new Date().toISOString(),level:t.failures?"warning":"info",message:`Precopy summary: ${t.successes||0} successes, ${t.failures||0} failures`,phase:r,rawLine:JSON.stringify({successes:t.successes,failures:t.failures,consecutiveFailures:t.consecutiveFailures,nextPrecopyAt:t.nextPrecopyAt},null,2)})}const Fn=/^\[\s*(\d+\.\d)\]\s+(.+)$/,Xe=/^\[\s*\d+\.\d{3,}\]/,Sa=/^libguestfs: trace: (\w+): (\S+)\s*(.*)/,Ca=/add_drive\s+"([^"]*)"\s+"format:([^"]*)"\s+"protocol:([^"]*)"\s+"server:([^"]*)"/,wa=/set_memsize\s+(\d+)/,ka=/set_smp\s+(\d+)/,ya=/^libguestfs: launch: backend=(.+)/,Aa=/guestfs_identifier=(\S+)/,_a=/^command:\s+(\S+)\s*(.*)/,ba=/^command:\s+(\S+)\s+returned\s+(\d+)/,Ia=/^command:\s+(\S+):\s+stdout:$/,Ea=/^commandrvf:\s+stdout=[yn]\s+stderr=[yn]\s+flags=/,xa=/^commandrvf:\s+(\S+)\s*(.*)/,La=/^chroot:\s+(\S+):\s+running\s+'([^']+)'/,Fa=/^libguestfs: command: run:\s*(.*)/,Ra=/virt-v2v monitoring:\s*Progress update, completed\s+(\d+)\s*%/,Na=/virt-v2v monitoring:\s*Copying disk\s+(\d+)\s+out of\s+(\d+)/,Ta=/^guestfsd:\s+<=\s+(\w+)\s+\(0x[\da-f]+\)/i,Ma=/^guestfsd:\s+=>\s+(\w+)\s+\(0x[\da-f]+\)\s+took\s+([\d.]+)\s+secs/i,Ci=/\berror[:\s]/i,wi=/\bwarning[:\s]/i,Pa=/^check_host_free_space:\s+large_tmpdir=(\S+)\s+free_space=(\d+)/,Oa=/^info:\s*(?:virt-v2v[\w-]*):\s*virt-v2v\s+([\d.]+\S*)/,Da=/^info:\s*libvirt version:\s*([\d.]+)/,Wa=/\bnbdkit\s+([\d]+\.[\d]+\.[\d]+)/,Ha=/VMware VixDiskLib \(([\d.]+)\)/,$a=/libguestfs:\s*qemu version[^:]*:\s*([\d.]+)/,Ba=/libguestfs: trace: \w+: version = <struct guestfs_version = major: (\d+), minor: (\d+), release: (\d+)/,Va=/virtio-win-([\d.]+)\.iso/,Ua=[/get_backend_setting = NULL \(error\)/,/usbserial.*error/i,/error: No error/,/TLS disabled/],Ga=["command:","commandrvf:","chroot:","guestfsd:","libguestfs:","nbdkit:","supermin:","libnbd:","info:","virt-v2v","umount-all:","Building command","windows:","hivex:","udev:","udevadm:","varlink:","list_filesystems:"],ja=["udevadm"],za=/^(?:No filesystem is currently mounted on|Failed to determine unit we run in|SELinux enabled state cached to|varlink:|udev:|udevadm:)/,Ya=/^(?:gulibguestfs:|estfsd:|uestfsd:|stfsd:|glibguestfs:|guelibguestfs:|gueslibguestfs:|guestfsdlibguestfs:|tfsd:)/,Ka=[{key:"virtV2v",re:Oa},{key:"libvirt",re:Da},{key:"nbdkit",re:Wa},{key:"vddk",re:Ha},{key:"qemu",re:$a},{key:"libguestfs",re:Ba,fmt:e=>`${e[1]}.${e[2]}.${e[3]}`},{key:"virtioWin",re:Va}];function qa(e){return Xe.test(e)?"kernel":Fn.test(e)?"stage":e.startsWith("nbdkit:")||e.startsWith("running nbdkit")?"nbdkit":e.startsWith("libguestfs:")?"libguestfs":e.startsWith("guestfsd:")?"guestfsd":e.startsWith("command:")||e.startsWith("commandrvf:")||e.startsWith("chroot:")?"command":e.startsWith("info:")?"info":/virt-v2v monitoring:/i.test(e)?"monitor":e.trimStart().startsWith("<")?"xml":/^\s*(apiVersion:|kind:|metadata:|spec:|status:|---\s*$)/.test(e)?"yaml":wi.test(e)?"warning":Ci.test(e)&&!yi(e)?"error":"other"}function Xa(e){for(const n of Ga)if(e.startsWith(n))return!0;return!!(Fn.test(e)&&!Xe.test(e)||Xe.test(e)||za.test(e)||Ya.test(e)||/^i_\w+\s*=/.test(e)||/^inspect_/.test(e)||/^fs:\s+\/dev\//.test(e)||/^check_filesystem:/.test(e)||/^check_for_filesystem/.test(e)||/^get_windows_systemroot/.test(e)||/^\/dev\/\S+\s+\(\w+\):/.test(e)||/^\s{4}\w[\w\s]*\w\s*:/.test(e))}function Za(e){return ja.includes(e)}function ki(e){if(!e)return[];const n=[],t=/'([^']*)'|"([^"]*)"|(\S+)/g;let r;for(;(r=t.exec(e))!==null;)n.push(r[1]??r[2]??r[3]);return n}function yi(e){for(const n of Ua)if(n.test(e))return!0;return!!(e.startsWith("nbdkit:")&&e.includes("debug:"))}function Ai(e){return e.startsWith("nbdkit:")?"nbdkit":e.startsWith("libguestfs:")?"libguestfs":e.startsWith("guestfsd:")?"guestfsd":e.startsWith("supermin:")?"supermin":e.startsWith("libnbd:")?"libnbd":/^virt-v2v-in-place:/.test(e)?"virt-v2v-in-place":/^virt-v2v-inspector:/.test(e)?"virt-v2v-inspector":/^virt-v2v-customize:|^virt-customize:/.test(e)?"virt-v2v-customize":/^virt-v2v:/.test(e)?"virt-v2v":"unknown"}function Qa(e,n,t){const r=e.some(o=>/Finishing off/i.test(o.name)),i=t.some(o=>/virt-v2v monitoring:\s*Finished/i.test(o)),s=n.some(o=>o.level==="error"&&/^virt-v2v/.test(o.source)&&!/warning/i.test(o.message)&&!/ignored\)/i.test(o.message));return s&&!r?"error":r||i?"success":s?"error":e.length>0?"in_progress":"unknown"}function Rn(e,n){const t=e[0]||"",r=e.slice(1);return{command:t,args:r,lineNumber:n}}function Ze(e,n){const t=`:${n}`;for(const[r,i]of e)if(r.endsWith(t)&&i.length>0)return i}function Nn(e,n,t){if(e.commands.length===0)return;const r=Ze(n,e.name);if(r&&r.length>0){r[0].guestCommands.push(...e.commands);return}for(let i=t.length-1;i>=0;i--)if(t[i].name===e.name){t[i].guestCommands.push(...e.commands);return}for(const i of n.values())if(i.length>0){i[0].guestCommands.push(...e.commands);return}}function Ja(e,n){for(const{key:t,re:r,fmt:i}of Ka)if(!n[t]){const s=e.match(r);s&&(n[t]=i?i(s):s[1])}}function _i(e,n){if(e[n]==="\\"&&n+3<e.length&&e[n+1]==="x"){const t=e.substring(n+2,n+4),r=parseInt(t,16);if(!isNaN(r))return{byte:r,consumed:4}}return null}function Qe(e,n){if(!e)return;const t=e.keySegments.join("\\");if(!t&&e.values.length===0)return;const r=e.hasWriteOp?"write":"read",i=r==="write"&&e.firstWriteLine?e.firstWriteLine:e.lineNumber,s=n.length>0?n[n.length-1]:null;if(s&&s.hivePath===e.hivePath&&s.keyPath===t&&s.mode===r&&s.lineNumber===i){s.values.push(...e.values);return}n.push({hivePath:e.hivePath,mode:r,openMode:e.openMode,keyPath:t,failedChild:e.failedChild||void 0,values:e.values,lineNumber:i})}function bi(e,n){const t=nl(e);if(n===4&&t.length>=4){const r=(t[0]|t[1]<<8|t[2]<<16|t[3]<<24>>>0)>>>0;return String(r)}return n===1||n===2||n===7?el(t):t.length<=16?t.map(r=>r.toString(16).padStart(2,"0")).join(" "):`(${t.length} bytes)`}function el(e){let n="";for(let t=0;t+1<e.length;t+=2){const r=e[t]|e[t+1]<<8;if(r===0)break;n+=String.fromCharCode(r)}return n}function nl(e){const n=[];let t=0;for(;t<e.length;){const r=_i(e,t);r?(n.push(r.byte),t+=r.consumed):(n.push(e.charCodeAt(t)),t++)}return n}const tl=/--unix['\s]+([^\s']+)/,il=/NBD URI:\s*(\S+)/,rl=/registered plugin\s+\S+\s+\(name\s+(\w+)\)/,sl=/registered filter\s+\S+\s+\(name\s+(\w+)\)/,ol=/config key=file, value=(.+)/,al=/config key=server, value=(\S+)/,ll=/config key=vm, value=moref=(\S+)/,cl=/transport mode:\s*(\w+)/,ul=/cow:\s+underlying file size:\s+(\d+)/;function Ii(e,n,t){const r=e.socketPath||`nbdkit-${n.size}`;n.has(r)||n.set(r,{id:r,socketPath:e.socketPath||"",uri:e.uri||"",plugin:e.plugin||"",filters:e.filters||[],diskFile:e.diskFile||"",startLine:e.startLine||t,endLine:t,logLines:e.logLines||[],server:e.server,vmMoref:e.vmMoref,transportMode:e.transportMode,backingSize:e.backingSize})}function fl(e,n){const t=e.indexOf("[0]{");if(t===-1)return;const i=e.slice(t).split(/\}\s*\[\d+\]\{/);for(const s of i){const o=s.replace(/^\[\d+\]\{/,"").replace(/\}\s*>?\s*$/,""),a={name:Ce(o,"app2_name"),displayName:Ce(o,"app2_display_name"),version:Ce(o,"app2_version"),publisher:Ce(o,"app2_publisher"),installPath:Ce(o,"app2_install_path"),description:Ce(o,"app2_description"),arch:Ce(o,"app2_arch")};(a.displayName||a.name)&&n.push(a)}}function Ce(e,n){const t=`${n}: `,r=e.indexOf(t);if(r===-1)return"";const i=r+t.length,s=e.indexOf(", app2_",i);return s===-1?e.slice(i).replace(/,?\s*$/,"").trim():e.slice(i,s).trim()}function pl(e){if(!e.startsWith("cpe:"))return"";const n=e.split(":");if(n.length>=6){const t=n[5];if(t&&t!=="*")return t}return""}function dl(e){const n=[],t=e.get("drive_mappings")||"";if(t){if(t.includes("=>"))for(const a of t.split(";")){const l=a.trim().match(/^(\w+)\s*=>\s*(.+)$/);l&&n.push({letter:l[1],device:l[2].trim()})}else{const a=/\((\w+),\s*([^)]+)\)/g;let l;for(;(l=a.exec(t))!==null;)n.push({letter:l[1].trim(),device:l[2].trim()})}n.sort((a,l)=>a.letter.localeCompare(l.letter))}const r=[],i=e.get("fstab")||"";if(i){const a=/\(([^,]+),\s*([^)]+)\)/g;let l;for(;(l=a.exec(i))!==null;)r.push({device:l[1].trim(),mountpoint:l[2].trim()})}let s=parseInt(e.get("major_version")||"0",10),o=parseInt(e.get("minor_version")||"0",10);if(s===0){const a=e.get("product_name")||"",l=pl(a);if(l){const c=l.split(".");s=parseInt(c[0]||"0",10),o=parseInt(c[1]||"0",10)}if(s===0&&e.has("version")){const c=(e.get("version")||"").split(".");s=parseInt(c[0]||"0",10),o=parseInt(c[1]||"0",10)}}return{root:e.get("root")||"",type:e.get("type")||"",distro:e.get("distro")||"",osinfo:e.get("osinfo")||"",arch:e.get("arch")||"",majorVersion:s,minorVersion:o,productName:e.get("product_name")||"",productVariant:e.get("product_variant")||"",packageFormat:e.get("package_format")||"",packageManagement:e.get("package_management")||"",hostname:e.get("hostname")||"",buildId:e.get("build_id")||"",windowsSystemroot:e.get("windows_systemroot")||"",windowsSoftwareHive:e.get("windows_software_hive")||"",windowsSystemHive:e.get("windows_system_hive")||"",windowsCurrentControlSet:e.get("windows_current_control_set")||"",driveMappings:n,fstab:r,blkid:[]}}const ml=/^(\/dev\/\S+):\s+(.+)$/,hl=/(\w+)="([^"]*)"/g;function gl(e){const n=e.match(ml);if(!n)return null;const t=n[1],i=[...n[2].matchAll(hl)];if(i.length===0)return null;const s={device:t};for(const o of i){const a=o[1].toUpperCase(),l=o[2];switch(a){case"UUID":s.uuid=l;break;case"TYPE":s.type=l;break;case"PARTLABEL":s.partLabel=l;break;case"PARTUUID":s.partUuid=l;break;case"LABEL":s.label=l;break}}return s}function vl(e){var f,p,d,m,h,S,w;const n=e.join(`
`),t={disks:[],networks:[]},r=n.match(/<name>([^<]+)<\/name>/);r&&(t.name=r[1]);const i=n.match(/<memory\s+unit='KiB'>(\d+)<\/memory>/);i&&(t.memoryKB=parseInt(i[1],10));const s=n.match(/<vcpu[^>]*>(\d+)<\/vcpu>/);s&&(t.vcpus=parseInt(s[1],10));const o=n.match(/<os>[\s\S]*?<type[^>]*>([^<]+)<\/type>/);o&&(t.firmware=o[1]),n.includes("<loader")||n.includes("ovmf")||n.includes("OVMF")?t.firmware="uefi":t.firmware==="hvm"&&(t.firmware="bios");const a=/<disk\s+[^>]*>[\s\S]*?<\/disk>/g;let l;for(;(l=a.exec(n))!==null;){const g=l[0],_=((f=g.match(/<source\s+file='([^']+)'/))==null?void 0:f[1])||((p=g.match(/<source\s+dev='([^']+)'/))==null?void 0:p[1])||((d=g.match(/<source\s+name='([^']+)'/))==null?void 0:d[1]),I=(m=g.match(/<target\s+dev='([^']+)'/))==null?void 0:m[1],x=(h=g.match(/<driver[^>]+type='([^']+)'/))==null?void 0:h[1];_&&t.disks.push({path:_,format:x,device:I})}const c=/<interface\s+type='([^']+)'[^>]*>[\s\S]*?<\/interface>/g;let u;for(;(u=c.exec(n))!==null;){const g=u[0],_=u[1],I=(S=g.match(/<model\s+type='([^']+)'/))==null?void 0:S[1],x=(w=g.match(/<source\s+(?:network|bridge|portgroup)='([^']+)'/))==null?void 0:w[1];t.networks.push({type:_,model:I,source:x})}return t}const Sl=/original size (\d+) bytes/;function Tn(e){const n=e.match(Sl);return n?parseInt(n[1],10):null}function Ei(e){let n="",t=0;for(;t<e.length;){const r=_i(e,t);if(r){n+=String.fromCharCode(r.byte),t+=r.consumed;continue}if(e[t]==="\\"&&t+1<e.length){const i=e[t+1];if(i==="n"){n+=`
`,t+=2;continue}if(i==="r"){n+="\r",t+=2;continue}if(i==="t"){n+="	",t+=2;continue}if(i==="\\"){n+="\\",t+=2;continue}if(i==='"'){n+='"',t+=2;continue}}n+=e[t],t++}return n}function Cl(e){const n='read_file = "',t=e.indexOf(n);if(t<0)return null;const r=t+n.length;let i=e.indexOf('"<truncated',r);if(i<0&&(i=e.lastIndexOf('"'),i<=r))return null;const s=e.substring(r,i);return/^\\x[0-9a-f]{2}\\x[0-9a-f]{2}/i.test(s)&&!/^\\x[0-9a-f]{2}\\x0[0ad]/i.test(s)?null:Ei(s)}function wl(e,n){if(/\.(exe|msi|dll|sys|cat|pdb|cab|iso|img|bin|dat|drv)$/i.test(n))return null;const r=e.indexOf('" "');if(r<0)return null;const i=r+3;let s=e.indexOf('"<truncated',i);if(s<0&&(s=e.lastIndexOf('"'),s<=i))return null;const o=e.substring(i,s);return Ei(o)}function kl(e,n){return{sectionLines:e,globalLineOffset:n,stages:[],diskProgress:[],nbdkitConnections:[],errors:[],lineCategories:[],completedApiCalls:[],openApiCalls:new Map,activeGuestfsd:null,hostCommands:[],lgBackend:"",lgIdentifier:"",lgMemsize:0,lgSmp:0,lgDrives:[],lgApiCalls:[],lgLaunchLines:[],currentNbdkit:null,nbdkitMap:new Map,pendingLibguestfsCmd:[],pendingLibguestfsCmdLine:0,stdoutCapture:null,guestInfo:null,guestInfoRaw:new Map,blkidEntries:[],versions:{},diskSummary:{disks:[]},sourceVM:null,xmlCapture:null,virtioWinIsoPath:null,fileCopies:[],pendingVirtioWinRead:null,pendingV2VReads:new Map,lastV2VReadFilePath:null,installedApps:[],registryHiveAccesses:[],currentHivexSession:null}}const Mn=/(\d+)\s+"([^"]+)"/,Pn=/^"(.*)"$/;function Je(e,n,t){Qe(n,e.registryHiveAccesses),n.keySegments=[],n.values=[],n.pendingGetValueName=null,n.pendingChildName=null,n.pendingChildParent=null,n.failedChild=null,n.hasWriteOp=(t==null?void 0:t.hasWriteOp)??!1,n.firstWriteLine=(t==null?void 0:t.firstWriteLine)??0,(t==null?void 0:t.lineNumber)!==void 0&&(n.lineNumber=t.lineNumber)}function On(e,n){if(e.activeGuestfsd)e.activeGuestfsd.commands.push(n);else{const t=[...e.openApiCalls.values()],r=t[t.length-1];r&&r.length>0&&r[r.length-1].guestCommands.push(n)}}function xi(e,n){if(e.activeGuestfsd){for(let t=e.activeGuestfsd.commands.length-1;t>=0;t--)if(e.activeGuestfsd.commands[t].command===n)return e.activeGuestfsd.commands[t]}for(const t of e.openApiCalls.values())for(let r=t.length-1;r>=0;r--){const i=t[r].guestCommands;for(let s=i.length-1;s>=0;s--)if(i[s].command===n)return i[s]}for(let t=e.completedApiCalls.length-1;t>=0;t--){const r=e.completedApiCalls[t].guestCommands;for(let i=r.length-1;i>=0;i--)if(r[i].command===n)return r[i]}}function yl(e,n){if(!e.stdoutCapture)return!1;if(Xa(n))return e.stdoutCapture=null,!1;const t=xi(e,e.stdoutCapture.cmdName);return t&&t.stdoutLines.push(n),!0}function Al(e,n,t){if(!Xe.test(n)){const r=n.match(Fn);r&&e.stages.push({name:r[2].trim(),elapsedSeconds:parseFloat(r[1]),lineNumber:t})}}function _l(e,n,t){const r=n.match(Ra);if(r){const s=e.diskProgress.length>0?e.diskProgress[e.diskProgress.length-1]:null;s&&e.diskProgress.push({diskNumber:s.diskNumber,totalDisks:s.totalDisks,percentComplete:parseInt(r[1],10),lineNumber:t})}const i=n.match(Na);i&&e.diskProgress.push({diskNumber:parseInt(i[1],10),totalDisks:parseInt(i[2],10),percentComplete:0,lineNumber:t})}function bl(e,n){if(Ja(n,e.versions),!e.diskSummary.hostFreeSpace){const t=n.match(Pa);t&&(e.diskSummary.hostTmpDir=t[1],e.diskSummary.hostFreeSpace=parseInt(t[2],10))}}function Il(e,n){e.xmlCapture!==null?(e.xmlCapture.push(n),n.trimStart().startsWith("</domain>")&&(e.sourceVM=vl(e.xmlCapture),e.xmlCapture=null)):!e.sourceVM&&/<domain type=/.test(n)&&(e.xmlCapture=[n])}function El(e,n,t){const r=n.startsWith("running nbdkit:")||n.startsWith("running nbdkit ");if(r&&(e.currentNbdkit={startLine:t,logLines:[],filters:[]}),r||n.startsWith("nbdkit:")||e.currentNbdkit&&n.startsWith(" ")){e.currentNbdkit&&(e.currentNbdkit.logLines=e.currentNbdkit.logLines||[],e.currentNbdkit.logLines.push(n),e.currentNbdkit.endLine=t);const i=n.match(tl);i&&e.currentNbdkit&&(e.currentNbdkit.socketPath=i[1]);const s=n.match(il);if(s&&e.currentNbdkit){e.currentNbdkit.uri=s[1];const d=e.currentNbdkit.socketPath||`nbdkit-${e.nbdkitMap.size}`;e.nbdkitMap.has(d)||e.nbdkitMap.set(d,{id:d,socketPath:e.currentNbdkit.socketPath||"",uri:e.currentNbdkit.uri||"",plugin:e.currentNbdkit.plugin||"",filters:e.currentNbdkit.filters||[],diskFile:e.currentNbdkit.diskFile||"",startLine:e.currentNbdkit.startLine||t,endLine:t,logLines:e.currentNbdkit.logLines||[],server:e.currentNbdkit.server,vmMoref:e.currentNbdkit.vmMoref,transportMode:e.currentNbdkit.transportMode,backingSize:e.currentNbdkit.backingSize})}const o=n.match(rl);o&&e.currentNbdkit&&(e.currentNbdkit.plugin=o[1]);const a=n.match(sl);a&&e.currentNbdkit&&(e.currentNbdkit.filters=e.currentNbdkit.filters||[],e.currentNbdkit.filters.includes(a[1])||e.currentNbdkit.filters.push(a[1]));const l=n.match(ol);l&&e.currentNbdkit&&(e.currentNbdkit.diskFile=l[1]);const c=n.match(al);c&&e.currentNbdkit&&(e.currentNbdkit.server=c[1]);const u=n.match(ll);u&&e.currentNbdkit&&(e.currentNbdkit.vmMoref=u[1]);const f=n.match(cl);f&&e.currentNbdkit&&(e.currentNbdkit.transportMode=f[1]);const p=n.match(ul);p&&e.currentNbdkit&&(e.currentNbdkit.backingSize=parseInt(p[1],10))}else e.currentNbdkit&&!n.startsWith("nbdkit:")&&(Ii(e.currentNbdkit,e.nbdkitMap,t),e.currentNbdkit=null);if(n.startsWith("nbdkit:")&&!e.currentNbdkit){const i=[...e.nbdkitMap.values()].pop();i&&(i.logLines.push(n),i.endLine=t)}}function xl(e,n,t){if(!n.startsWith("libguestfs:"))return;const r=n.match(ya);r&&(e.lgBackend=r[1],e.lgLaunchLines.push(n));const i=n.match(Aa);i&&(e.lgIdentifier=i[1]),n.includes("libguestfs: launch:")&&e.lgLaunchLines.push(n);const s=n.match(Sa);if(s){const a=s[1],l=s[2],c=s[3],u=c.match(wa);u&&(e.lgMemsize=parseInt(u[1],10));const f=c.match(ka);f&&(e.lgSmp=parseInt(f[1],10));const p=n.match(Ca);if(p&&e.lgDrives.push({path:p[1],format:p[2],protocol:p[3],server:p[4]}),l==="inspect_list_applications2"&&c.startsWith("=")&&fl(c,e.installedApps),Ll(e,l,c,t),!l.endsWith("=")&&l!=="=")e.lgApiCalls.push({name:l,args:c,result:"",lineNumber:t});else if(l==="="||c.startsWith("=")){const m=e.lgApiCalls[e.lgApiCalls.length-1];m&&(m.result=c.replace(/^=\s*/,"").trim()||l)}if(!(l==="="||c.startsWith("="))&&!l.endsWith("=")){const m={name:l,args:c,result:"",handle:a,guestCommands:[],lineNumber:t},h=`${a}:${l}`,S=e.openApiCalls.get(h)||[];S.push(m),e.openApiCalls.set(h,S)}else{let m="",h="";if(l==="="){const S=e.lgApiCalls[e.lgApiCalls.length-1];S&&(m=S.name),h=c.replace(/^=?\s*/,"").trim()}else c.startsWith("=")&&(m=l.replace(/=$/,""),h=c.replace(/^=\s*/,"").trim());if(m){const S=`${a}:${m}`,w=e.openApiCalls.get(S);if(w&&w.length>0){const g=w.shift();g.result=h,e.completedApiCalls.push(g),w.length===0&&e.openApiCalls.delete(S)}}}}const o=n.match(Fa);if(o){const a=o[1].trim();a&&!a.startsWith("\\")?(e.pendingLibguestfsCmd.length>0&&e.hostCommands.push(Rn(e.pendingLibguestfsCmd,e.pendingLibguestfsCmdLine)),e.pendingLibguestfsCmd=[a],e.pendingLibguestfsCmdLine=t):a.startsWith("\\")&&e.pendingLibguestfsCmd.push(a.slice(1).trim())}}function Ll(e,n,t,r){if(n==="hivex_open"&&!t.startsWith("=")){Qe(e.currentHivexSession,e.registryHiveAccesses);const i=t.match(/^"([^"]+)"/);if(i){const s=t.includes("write:true")?"write":"read";e.currentHivexSession={hivePath:i[1],mode:s,openMode:s,keySegments:[],values:[],pendingGetValueName:null,pendingChildName:null,pendingChildParent:null,failedChild:null,lineNumber:r,rootHandle:"",hasWriteOp:!1,firstWriteLine:0}}}if(n==="hivex_root"&&e.currentHivexSession&&(t.startsWith("= ")?e.currentHivexSession.rootHandle=t.slice(2).trim():(e.currentHivexSession.keySegments.length>0||e.currentHivexSession.values.length>0)&&Je(e,e.currentHivexSession)),n==="hivex_node_get_child"&&e.currentHivexSession)if(t.startsWith("= ")){const i=t.slice(2).trim();i!=="0"&&e.currentHivexSession.pendingChildName?e.currentHivexSession.keySegments.push(e.currentHivexSession.pendingChildName):i==="0"&&e.currentHivexSession.pendingChildName&&(e.currentHivexSession.failedChild=e.currentHivexSession.pendingChildName),e.currentHivexSession.pendingChildName=null,e.currentHivexSession.pendingChildParent=null}else{const i=t.match(Mn);if(i){const s=i[1],o=i[2];e.currentHivexSession.rootHandle&&s===e.currentHivexSession.rootHandle&&e.currentHivexSession.keySegments.length>0&&Je(e,e.currentHivexSession,{lineNumber:r}),e.currentHivexSession.pendingChildName=o,e.currentHivexSession.pendingChildParent=s}}if(n==="hivex_node_add_child"&&!t.startsWith("=")&&e.currentHivexSession){e.currentHivexSession.hasWriteOp=!0,e.currentHivexSession.firstWriteLine||(e.currentHivexSession.firstWriteLine=r);const i=t.match(Mn);if(i){const s=i[1],o=i[2];e.currentHivexSession.rootHandle&&s===e.currentHivexSession.rootHandle&&e.currentHivexSession.keySegments.length>0&&Je(e,e.currentHivexSession,{hasWriteOp:!0,firstWriteLine:r,lineNumber:r}),e.currentHivexSession.failedChild===o&&(e.currentHivexSession.failedChild=null),e.currentHivexSession.keySegments.push(o)}}if(n==="hivex_node_get_value"&&e.currentHivexSession)if(t.startsWith("= "))t.slice(2).trim()==="0"&&(e.currentHivexSession.pendingGetValueName=null);else{const i=t.match(Mn);i&&(e.currentHivexSession.pendingGetValueName=i[2])}if(n==="hivex_value_string"&&e.currentHivexSession&&t.startsWith("= ")){const s=t.slice(2).trim().match(Pn);s&&e.currentHivexSession.pendingGetValueName&&(e.currentHivexSession.values.push({name:e.currentHivexSession.pendingGetValueName,value:s[1],lineNumber:r}),e.currentHivexSession.pendingGetValueName=null)}if(n==="hivex_value_value"&&e.currentHivexSession&&t.startsWith("= ")){const s=t.slice(2).trim().match(Pn);s&&e.currentHivexSession.pendingGetValueName&&(e.currentHivexSession.values.push({name:e.currentHivexSession.pendingGetValueName,value:bi(s[1],1),lineNumber:r}),e.currentHivexSession.pendingGetValueName=null)}if(n==="hivex_value_key"&&e.currentHivexSession&&t.startsWith("= ")){const s=t.slice(2).trim().match(Pn);s&&(e.currentHivexSession.pendingGetValueName=s[1])}if(n==="hivex_commit"&&!t.startsWith("=")&&e.currentHivexSession&&(e.currentHivexSession.hasWriteOp=!0,e.currentHivexSession.firstWriteLine||(e.currentHivexSession.firstWriteLine=r),(e.currentHivexSession.values.length>0||e.currentHivexSession.keySegments.length>0)&&Je(e,e.currentHivexSession)),n==="hivex_node_set_value"&&!t.startsWith("=")&&e.currentHivexSession){e.currentHivexSession.hasWriteOp=!0,e.currentHivexSession.firstWriteLine||(e.currentHivexSession.firstWriteLine=r);const i=t.match(/^\d+\s+"([^"]+)"\s+(\d+)\s+"(.+)"$/);if(i){const s=i[1],o=parseInt(i[2],10),a=i[3];e.currentHivexSession.values.push({name:s,value:bi(a,o),lineNumber:r})}}n==="hivex_close"&&!t.startsWith("=")&&e.currentHivexSession&&(Qe(e.currentHivexSession,e.registryHiveAccesses),e.currentHivexSession=null)}function Fl(e,n){e.pendingLibguestfsCmd.length>0&&!n.startsWith("libguestfs:")&&!n.trim().startsWith("\\")&&(e.hostCommands.push(Rn(e.pendingLibguestfsCmd,e.pendingLibguestfsCmdLine)),e.pendingLibguestfsCmd=[])}function Rl(e,n){if(!n.startsWith("guestfsd:"))return;const t=n.match(Ta);t&&(e.activeGuestfsd&&Nn(e.activeGuestfsd,e.openApiCalls,e.completedApiCalls),e.activeGuestfsd={name:t[1],commands:[]});const r=n.match(Ma);if(r){const i=parseFloat(r[2]);if(e.activeGuestfsd){const s=r[1],o=Ze(e.openApiCalls,s)||Ze(e.openApiCalls,e.activeGuestfsd.name);o&&o.length>0&&(o[0].durationSecs=i),Nn(e.activeGuestfsd,e.openApiCalls,e.completedApiCalls),e.activeGuestfsd=null}else{const s=Ze(e.openApiCalls,r[1]);s&&s.length>0&&(s[0].durationSecs=i)}}}function Nl(e,n,t){if(n.startsWith("libguestfs:")||n.startsWith("guestfsd:"))return!1;const r=n.match(Ia);if(r)return e.stdoutCapture={cmdName:r[1]},!0;const i=n.match(ba);if(i){const s=parseInt(i[2],10),o=xi(e,i[1]);return o&&o.returnCode===void 0&&(o.returnCode=s),!0}if(n.startsWith("command:")){const s=n.match(_a);if(s){const o=ki(s[2]);On(e,{command:s[1],args:o,source:"command",stdoutLines:[],lineNumber:t})}}if(n.startsWith("commandrvf:")&&!Ea.test(n)){const s=n.match(xa);if(s&&!Za(s[1])){const o=ki(s[2]);On(e,{command:s[1],args:o,source:"commandrvf",stdoutLines:[],lineNumber:t})}}if(n.startsWith("chroot:")){const s=n.match(La);s&&On(e,{command:s[2],args:[],source:"chroot",stdoutLines:[],lineNumber:t})}return!1}function Tl(e,n){const t=n.match(/^i_(\w+)\s*=\s*(.+)$/);t&&e.guestInfoRaw.set(t[1],t[2].trim());const r=n.match(/^(\/dev\/\S+)\s+\(\w+\):\s*$/);r&&!e.guestInfoRaw.has("root")&&e.guestInfoRaw.set("root",r[1]);const i=n.match(/^fs:\s+(\/dev\/\S+)\s+\(\w+\)\s+role:\s+(\w+)/);i&&i[2]==="root"&&!e.guestInfoRaw.has("root")&&e.guestInfoRaw.set("root",i[1]);const s=n.match(/^\s{4}(\w[\w\s]*\w)\s*:\s*(.+)$/);if(s){const o=s[1].trim(),a=s[2].trim(),c={type:"type",distro:"distro",arch:"arch",hostname:"hostname",version:"version",product_name:"product_name",product_variant:"product_variant",package_format:"package_format",package_management:"package_management","build ID":"build_id",fstab:"fstab",drive_mappings:"drive_mappings",windows_systemroot:"windows_systemroot",windows_software_hive:"windows_software_hive",windows_system_hive:"windows_system_hive",windows_current_control_set:"windows_current_control_set"}[o];c&&!e.guestInfoRaw.has(c)&&e.guestInfoRaw.set(c,a)}}function Ml(e,n){const t=gl(n);t&&!e.blkidEntries.some(r=>r.device===t.device)&&e.blkidEntries.push(t)}function Pl(e,n,t){const r=n.match(/copy_from_virtio_win:\s+guest tools source ISO\s+(\S+)/);r&&(e.virtioWinIsoPath=r[1]);const i=n.match(/libguestfs: trace: virtio_win: read_file "(\/\/\/[^"]+)"/);if(i&&(e.pendingVirtioWinRead={source:i[1],sizeBytes:null,lineNumber:t}),e.pendingVirtioWinRead){const l=Tn(n);l!==null&&(e.pendingVirtioWinRead.sizeBytes=l)}const s=n.match(/libguestfs: trace: v2v: read_file "([^"]+)"/);if(s&&!n.includes("read_file =")){const l=s[1];e.lastV2VReadFilePath=l,e.pendingV2VReads.set(l,{content:null,sizeBytes:null,lineNumber:t})}if(e.lastV2VReadFilePath&&n.match(/libguestfs: trace: v2v: read_file = /)){const c=e.pendingV2VReads.get(e.lastV2VReadFilePath);if(c){const u=Tn(n);u!==null&&(c.sizeBytes=u);const f=Cl(n);f!==null&&(c.content=f)}e.lastV2VReadFilePath=null}const o=n.match(/libguestfs: trace: v2v: write "([^"]+)"/);if(o){const l=o[1],c=Tn(n),u=n.includes("<truncated,"),f=wl(n,l);if(e.pendingVirtioWinRead)e.fileCopies.push({source:e.pendingVirtioWinRead.source,destination:l,sizeBytes:e.pendingVirtioWinRead.sizeBytes??c,origin:"virtio_win",content:null,contentTruncated:!1,lineNumber:e.pendingVirtioWinRead.lineNumber}),e.pendingVirtioWinRead=null;else if(e.pendingV2VReads.has(l)){const p=e.pendingV2VReads.get(l);e.fileCopies.push({source:l,destination:l,sizeBytes:p.sizeBytes??c,origin:"guest",content:f??p.content,contentTruncated:u,lineNumber:p.lineNumber}),e.pendingV2VReads.delete(l)}else e.fileCopies.push({source:"(generated)",destination:l,sizeBytes:c,origin:"script",content:f,contentTruncated:u,lineNumber:t})}const a=n.match(/libguestfs: trace: v2v: upload "([^"]+)" "([^"]+)"/);if(a){const l=a[1],c=a[2];l.startsWith("/tmp/")||e.fileCopies.push({source:l,destination:c,sizeBytes:null,origin:"virt-tools",content:null,contentTruncated:!1,lineNumber:t})}}function Ol(e,n,t){if(Ci.test(n)&&!yi(n)){const r=Ai(n);e.errors.push({level:"error",source:r,message:n,lineNumber:t,rawLine:n})}else if(wi.test(n)){const r=Ai(n);e.errors.push({level:"warning",source:r,message:n,lineNumber:t,rawLine:n})}}function Dl(e){e.pendingLibguestfsCmd.length>0&&e.hostCommands.push(Rn(e.pendingLibguestfsCmd,e.pendingLibguestfsCmdLine)),e.activeGuestfsd&&Nn(e.activeGuestfsd,e.openApiCalls,e.completedApiCalls),e.currentNbdkit&&Ii(e.currentNbdkit,e.nbdkitMap,e.globalLineOffset+e.sectionLines.length-1);for(const n of e.openApiCalls.values())e.completedApiCalls.push(...n);e.completedApiCalls.sort((n,t)=>n.lineNumber-t.lineNumber),e.guestInfoRaw.size>0&&(e.guestInfoRaw.has("root")||e.guestInfoRaw.has("type")||e.guestInfoRaw.has("distro"))&&(e.guestInfo=dl(e.guestInfoRaw),e.guestInfo.blkid=e.blkidEntries),Qe(e.currentHivexSession,e.registryHiveAccesses),e.currentHivexSession=null,e.nbdkitConnections.push(...e.nbdkitMap.values()),e.nbdkitConnections.forEach((n,t)=>{e.diskSummary.disks.push({index:t+1,sizeBytes:n.backingSize,sourceFile:n.diskFile||void 0,transportMode:n.transportMode,server:n.server,vmMoref:n.vmMoref})})}const Li=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z\s+/,Wl=/^Building command:\s*(\S+)\s+\[(.*)]/,Dn=/Building command:(\S+?)\[([^\]]*)\]/g;function Hl(e){const n=e.slice(0,3e3).replace(Li,"").replace(/\n\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z\s+/g,`
`);return!!(/Building command[:\s]*virt-v2v/i.test(n)||/^info:\s*virt-v2v/m.test(n)||/^virt-v2v:/m.test(n)||/virt-v2v-in-place/i.test(n)||/virt-v2v-inspector/i.test(n)||/^libguestfs:\s+trace:/m.test(n))}function $l(e){try{return Bl(e)}catch(n){return console.error("parseV2VLog failed:",n),{toolRuns:[],totalLines:0}}}function Bl(e){const n=e.split(`
`),t=Vl(n),r=t.length,i=Gl(t),s=[];for(let o=0;o<i.length;o++){const a=i[o].lineIndex,l=o+1<i.length?i[o+1].lineIndex:r,c=t.slice(a,l),u=Ri(c,i[o].tool,i[o].commandLine,a);s.push(u)}if(s.length===0){const o=jl(t),a=Ri(t,o,"",0);s.push(a)}return{toolRuns:s,totalLines:r}}function Vl(e){const n=[];for(let t of e){t=t.replace(Li,"");const r=Ul(t);if(r.length>1){n.push(...r);continue}if(!t.startsWith("libguestfs:")&&t.includes("libguestfs: trace:")){const i=t.indexOf("libguestfs: trace:"),s=t.slice(0,i).trim(),o=t.slice(i);s&&n.push(s),n.push(o);continue}if(t.startsWith("libguestfs: trace:")){const i=t.indexOf("libguestfs: trace:",1);if(i>0){n.push(t.slice(0,i).trim()),n.push(t.slice(i));continue}}n.push(t)}return n}function Ul(e){if([...e.matchAll(Dn)].length<=1){const s=e.match(/Building command:/g);if(!s||s.length<=1)return[e]}const t=[],r=[];let i=0;for(;;){const s=e.indexOf("Building command:",i);if(s===-1)break;r.push(s),i=s+17}for(let s=0;s<r.length;s++){const o=r[s],a=s+1<r.length?r[s+1]:e.length,l=e.slice(o,a).trim();l&&t.push(l)}if(r.length>0&&r[0]>0){const s=e.slice(0,r[0]).trim();s&&t.unshift(s)}return t.length>0?t:[e]}function Gl(e){const n=[];for(let t=0;t<e.length;t++){const r=e[t],i=r.match(Wl);if(i){const o=Fi(i[1]);if(o){n.push({lineIndex:t,tool:o,commandLine:i[2]});continue}}Dn.lastIndex=0;const s=Dn.exec(r);if(s){const o=Fi(s[1]);if(o){n.push({lineIndex:t,tool:o,commandLine:s[2]});continue}}}return n}function Fi(e){const n=e.toLowerCase();return n==="virt-v2v-in-place"?"virt-v2v-in-place":n==="virt-v2v-inspector"?"virt-v2v-inspector":n==="virt-v2v-customize"||n==="virt-customize"?"virt-v2v-customize":n==="virt-v2v"?"virt-v2v":n.includes("monitor")?null:n.includes("virt-v2v")?"virt-v2v":null}function jl(e){const n=e.slice(0,20).join(`
`);return/virt-v2v-in-place/i.test(n)?"virt-v2v-in-place":/virt-v2v-inspector/i.test(n)?"virt-v2v-inspector":/virt-v2v-customize|virt-customize/i.test(n)?"virt-v2v-customize":"virt-v2v"}function Ri(e,n,t,r){const i=kl(e,r);for(let a=0;a<e.length;a++){const l=e[a],c=r+a;if(!l.trim()){i.lineCategories.push("other");continue}const u=qa(l);i.lineCategories.push(u),!yl(i,l)&&(Al(i,l,c),_l(i,l,c),bl(i,l),Il(i,l),El(i,l,c),xl(i,l,c),Fl(i,l),Rl(i,l),!Nl(i,l,c)&&(Tl(i,l),Ml(i,l),Pl(i,l,c),Ol(i,l,c)))}Dl(i);const s={backend:i.lgBackend,identifier:i.lgIdentifier,memsize:i.lgMemsize,smp:i.lgSmp,drives:i.lgDrives,apiCalls:i.lgApiCalls,launchLines:i.lgLaunchLines},o=Qa(i.stages,i.errors,e);return{tool:n,commandLine:t,exitStatus:o,startLine:r,endLine:r+e.length-1,stages:i.stages,diskProgress:i.diskProgress,nbdkitConnections:i.nbdkitConnections,libguestfs:s,apiCalls:i.completedApiCalls,hostCommands:i.hostCommands,guestInfo:i.guestInfo,installedApps:i.installedApps,registryHiveAccesses:i.registryHiveAccesses,virtioWin:{isoPath:i.virtioWinIsoPath,fileCopies:i.fileCopies},versions:i.versions,diskSummary:i.diskSummary,sourceVM:i.sourceVM,errors:i.errors,rawLines:e,lineCategories:i.lineCategories}}function en(e,n){return!e&&!n?Xl():e?n?zl(e,n):e:n}function Ni(e,n){const t=new Set(e.map(i=>`${i.namespace}/${i.name}`)),r=[...e];for(const i of n){const s=`${i.namespace}/${i.name}`;t.has(s)||(t.add(s),r.push(i))}return r}function zl(e,n){const t=new Map;for(const u of n.plans)t.set(Wn(u),u);const r=[],i=new Set;for(const u of e.plans){const f=Wn(u),p=t.get(f);p?(i.add(f),r.push(Yl(u,p))):r.push(u)}for(const u of n.plans)i.has(Wn(u))||r.push(u);const s=[...e.events,...n.events];s.sort((u,f)=>u.timestamp.localeCompare(f.timestamp));const o={totalLines:e.stats.totalLines+n.stats.totalLines,parsedLines:e.stats.parsedLines+n.stats.parsedLines,errorLines:e.stats.errorLines+n.stats.errorLines,duplicateLines:e.stats.duplicateLines+n.stats.duplicateLines,plansFound:r.length,vmsFound:r.reduce((u,f)=>u+Object.keys(f.vms).length,0)},a=ql(r),l=Ni(e.networkMaps||[],n.networkMaps||[]),c=Ni(e.storageMaps||[],n.storageMaps||[]);return{plans:r,events:s,stats:o,summary:a,networkMaps:l,storageMaps:c}}function Ti(e){return Object.values(e.vms).some(n=>!n.fromYaml)}function Yl(e,n){const t=Ti(n),r=Ti(e),[i,s]=t&&!r?[n,e]:[e,n],o={...i};if(s.spec&&!o.spec&&(o.spec=s.spec),s.archived&&(o.archived=!0),(o.status==="Pending"||o.status==="Ready")&&s.status!=="Pending"&&s.status!=="Ready"&&(o.status=s.status),s.conditions.length>0){const a=new Set(o.conditions.map(l=>l.type));for(const l of s.conditions)a.has(l.type)||o.conditions.push(l)}s.errors.length>0&&o.errors.length===0&&(o.errors=[...s.errors]),s.panics.length>0&&o.panics.length===0&&(o.panics=[...s.panics]);for(const[a,l]of Object.entries(s.vms)){const c=o.vms[a];c?Kl(c,l):o.vms[a]=l}return o}function Kl(e,n){n.operatingSystem&&!e.operatingSystem&&(e.operatingSystem=n.operatingSystem),n.restorePowerState&&!e.restorePowerState&&(e.restorePowerState=n.restorePowerState),n.newName&&!e.newName&&(e.newName=n.newName),n.error&&!e.error&&(e.error=n.error),n.conditions&&(!e.conditions||e.conditions.length===0)&&(e.conditions=n.conditions),n.warmInfo&&!e.warmInfo&&(e.warmInfo=n.warmInfo,e.precopyCount=n.precopyCount)}function Wn(e){return`${e.namespace}/${e.name}`}function ql(e){const n={totalPlans:e.length,running:0,succeeded:0,failed:0,archived:0,pending:0};for(const t of e)switch(t.archived&&n.archived++,t.status){case"Running":n.running++;break;case"Succeeded":n.succeeded++;break;case"Failed":n.failed++;break;case"Pending":case"Ready":n.pending++;break}return n}function Xl(){return{plans:[],events:[],stats:{totalLines:0,parsedLines:0,errorLines:0,duplicateLines:0,plansFound:0,vmsFound:0},summary:{totalPlans:0,running:0,succeeded:0,failed:0,archived:0,pending:0},networkMaps:[],storageMaps:[]}}const Mi=/namespaces\/([^/]+)\/(?:pods|logs)\/(.+)-vm-(\d+)-[a-z0-9][-a-z0-9]*\//,Zl=[".yaml",".yml",".json",".xml",".html",".css",".js",".png",".jpg",".gif",".pdf"];function Ql(e){const n=e.toLowerCase();return Zl.some(t=>n.endsWith(t))?!1:Mi.test(e)?!0:n.includes("/virt-v2v/")||n.includes("/virt-v2v-inspector/")}const Jl=['"logger":"plan|','"logger": "plan|','"controller":"plan"','"controller": "plan"'],Ie=8*1024;function ec(e){var t;const n=e.content.length>Ie?e.content.slice(0,Ie):e.content;for(const r of Jl)if(n.includes(r))return!0;if(e.path.toLowerCase().includes("forklift-controller")){const r=(t=n.trimStart().split(`
`,1)[0])==null?void 0:t.trim();if(r!=null&&r.startsWith("{"))return!0}return!1}const nc=/kind:\s*Plan\b/,tc=/kind:\s*NetworkMap\b/,ic=/kind:\s*StorageMap\b/,rc=/forklift\.konveyor\.io/;function sc(e){const n=e.content.length>Ie?e.content.slice(0,Ie):e.content;return rc.test(n)?nc.test(n)||tc.test(n)||ic.test(n):!1}async function oc(e,n){try{return await ac(e,n)}catch(t){return console.error("processArchive failed:",t),{logFiles:[],yamlFiles:[],v2vFiles:[],v2vFileEntries:[],parsedData:en(null,null)}}}async function ac(e,n){n==null||n("Extracting archive...",e.name);const t=await nt(e);n==null||n("Classifying files...",`${t.length} files extracted`);const r=[],i=[],s=[];for(const u of t)ec(u)?r.push(u):sc(u)?i.push(u):(Ql(u.path)||Hl(u.content.length>Ie?u.content.slice(0,Ie):u.content))&&s.push(u);let o=null,a=null;const l=[];if(r.length>0&&(n==null||n("Parsing controller logs...",`${r.length} file${r.length!==1?"s":""}`),o=lc(r)),i.length>0){n==null||n("Parsing Forklift YAMLs...",`${i.length} file${i.length!==1?"s":""}`);const u=i.map(f=>f.content).join(`
---
`);a=fa(u)}if(s.length>0){n==null||n("Parsing V2V logs...",`${s.length} file${s.length!==1?"s":""}`);for(const u of s){const f=$l(u.content);f.fileName=u.path;const p=Mi.exec(u.path);l.push({filePath:u.path,data:f,planName:p==null?void 0:p[2],vmId:p?`vm-${p[3]}`:void 0})}}n==null||n("Merging results...");const c=en(o,a);return{logFiles:r.map(u=>u.path),yamlFiles:i.map(u=>u.path),v2vFiles:s.map(u=>u.path),v2vFileEntries:l,parsedData:c}}function lc(e){if(e.length===1)return pt(e[0].content);let n=null;for(const t of e){const r=pt(t.content);n=n?en(n,r):r}return n??en(null,null)}const nn=self;nn.onmessage=async e=>{const n=e.data;if(n.type==="processArchive")try{const t=await oc(n.file,(r,i)=>{nn.postMessage({type:"progress",stage:r,detail:i})});nn.postMessage({type:"result",data:t})}catch(t){nn.postMessage({type:"error",message:t instanceof Error?t.message:String(t)})}}})();
//# sourceMappingURL=archiveWorker-rFP_5GeN.js.map
